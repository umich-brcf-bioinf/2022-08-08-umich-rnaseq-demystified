<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="UM Bioinformatics Core" />

<meta name="date" content="2022-08-04" />

<title>Module 07: DESeq2 Initialization</title>

<script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link rel="shortcut icon" href="favicon-16x16.png" />
<!--
Favicon from
https://twemoji.twitter.com/
https://favicon.io/emoji-favicons/dna/
-->

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">RNA-Seq Demystified</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="Module00_Introduction.html">Intro</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Sequence QC
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module01_Warming_Up.html">Warming up</a>
    </li>
    <li>
      <a href="Module02a_QC.html">Quality Control</a>
    </li>
    <li>
      <a href="Module02b_Cutadapt_MoreQC.html">Cutadapt/MoreQC</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Alignment
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module03_Reference_Genomes.html">Reference Genomes</a>
    </li>
    <li>
      <a href="Module04_Alignment.html">Alignment/Quantification (STAR/RSEM)</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Quantification
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module05a_MultiQC_and_Count_Matrix.html">Count matrix / Alignment QC</a>
    </li>
    <li>
      <a href="Module05b_Additional_Details.html">Optional: Additional details</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Groups/Model
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module06_DEAnalysisSetup.html">Introduction to DESeq2</a>
    </li>
    <li>
      <a href="Module07_DESeq2Init.html">DESeq2 Initialization</a>
    </li>
    <li>
      <a href="Module08_DESeq2DE.html">Count Normalizations and DESeq2 model fitting</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Expression plots
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module09_SampleQCViz.html">Sample Visualizations for QC</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Diff Expression
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module10_DEComparisons.html">Comparisons</a>
    </li>
    <li>
      <a href="Module11_DEVisualizations.html">DE Visiualization and Annotation</a>
    </li>
    <li>
      <a href="Module11X_BonusContent.html">Bonus content</a>
    </li>
  </ul>
</li>
<li>
  <a href="Module99_Wrap_up.html">Wrap up</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Module 07: DESeq2 Initialization</h1>
<h4 class="author">UM Bioinformatics Core</h4>
<h4 class="date">2022-08-04</h4>

</div>


<style type="text/css">
body, td {
   font-size: 18px;
}
code.r{
  font-size: 12px;
}
pre {
  font-size: 12px
}
</style>
<blockquote>
<h1 id="objectives" class="unlisted unnumbered">Objectives</h1>
<ul>
<li>‘Unblind’ our sample IDs</li>
<li>Understand possible confounding factors</li>
<li>Understand the impact of batches or additional covariates</li>
<li>Filter count table</li>
</ul>
</blockquote>
<div id="differential-expression-workflow" class="section level1">
<h1>Differential Expression Workflow</h1>
<p>Here we will proceed setting up the inputs needed to initialize
DESeq2 before testing for differential expression.</p>
<p><img src="images/wayfinder/wayfinder-07.png"
style="width:75.0%" /></p>
<hr />
</div>
<div id="deseq2-objects" class="section level1">
<h1>DESeq2 objects</h1>
<p>Bioconductor software packages often define and use custom classes
within R to store data in a way that better fits expectations around
biological data, such as illustrated below from <a
href="https://www.nature.com/articles/nmeth.3252">Huber et
al. 2015</a>.</p>
<p><img src="images/SummarizedExperiment.jpg" /></p>
<p>These custom data structures have pre-specified data slots, which
hold specific types/classes of data and therefore can be more easily
accessed by functions from the same package.</p>
<p>To create the DESeqDataSet we need two tables:</p>
<ol style="list-style-type: decimal">
<li>a count matrix (which we already loaded)</li>
<li>a table that assigns the condition labels for each sample (which we
will generate below).</li>
</ol>
</div>
<div id="sample-information" class="section level1">
<h1>Sample Information</h1>
<p>For this representative dataset, we have somewhat limited information
from <a
href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE144588">public
records</a>, but we know these samples were isolated from either
wild-type or knock-out T-cells harvested from control mice or isolated
from previously transplanted mice.</p>
<div id="generate-sample-table" class="section level2">
<h2>Generate Sample Table</h2>
<p>Our next step will be to describe the samples within our R session,
so that we make the proper comparisons with DESeq2. The first step is to
check the sample names from the count table.</p>
<pre class="r"><code>colnames(count_table)</code></pre>
<pre><code>[1] &quot;SRR7777895&quot; &quot;SRR7777896&quot; &quot;SRR7777897&quot; &quot;SRR7777898&quot; &quot;SRR7777899&quot; &quot;SRR7777900&quot;</code></pre>
<p>When we looked at our <code>count_table</code>, our samples are
blinded, e.g. the sample names don’t correspond to any of the expected
treatment groups. So we will need to specify which sample IDs connect to
which experimental conditions.</p>
<p>Since there are a large number of samples (and to increase the
reproduciblity of our code), we would generate a sample information
table in excel and exported it as a ‘.csv’ file so that it is in a
‘plain text’ format that can be easily loaded into our R session.</p>
<details>
<summary>
<em>Click for sample naming conventions</em>
</summary>
<p>A critical aspect of creating a sample sheet in excel is to avoid
using spaces or characters that have special uses in R, such as dashes
or parentheses. Simple sample group names are best. If you are unfamilar
with ‘.csv’ files or how to generate them, there are <a
href="https://www.wikihow.com/Create-a-CSV-File">tutorials</a> available
to guide you through the process.</p>
</details>
<p>We’ll load our ‘pre-made’ sample information sheet,
<code>samplesheet.csv</code>, to unblind our samples.</p>
<pre class="r"><code>samplesheet = read.table(&quot;data/samplesheet.csv&quot;,
                       sep = &quot;,&quot;,
                       header = TRUE,
                       row.names = 1)</code></pre>
<pre class="r"><code>samplesheet</code></pre>
<pre><code>           genotype condition
SRR7777895       wt      plus
SRR7777896       wt      plus
SRR7777897       wt      plus
SRR7777898       wt     minus
SRR7777899       wt     minus
SRR7777900       wt     minus</code></pre>
<p><strong>Checkpoint</strong>: <em>If you have loaded
<code>samplesheet</code>, please indicate with the green ‘check’ button.
Otherwise, please use the red ‘x’ button to have the command
repeated</em></p>
<p>How are the treatment groups encoded in the table we just loaded?</p>
<pre class="r"><code>unique(samplesheet$condition)</code></pre>
<pre><code>[1] &quot;plus&quot;  &quot;minus&quot;</code></pre>
<p>Next, we’ll format our table so that we have the appropriate data
type (an ordered <a
href="https://swcarpentry.github.io/r-novice-inflammation/12-supp-factors/">factor</a>)
for DESeq2 to recognize our treatment groups and appropriately compare
samples.</p>
<pre class="r"><code>samplesheet$condition = factor(samplesheet$condition,
                            levels = c(&#39;minus&#39;, &#39;plus&#39;))

unique(samplesheet$condition)</code></pre>
<pre><code>[1] plus  minus
Levels: minus plus</code></pre>
<p>Notice that we set the levels in a particular order. This is
important for setting the ‘Control’ group as the denominator in our
comparisons when we setup our DESeq2 model. The ‘Case’ name should be
last if there are only two groups &amp; first if there are only three
groups to generate default pair-wise comparisons.</p>
<p>Before we proceed, we need to make sure that the sample labels
(column names) in the count table match the sample information table
(row names), including the order.</p>
<p>If the sample labels don’t match, then we will see an error and need
to correct the labels prior to proceeding. Checking the sample
information table is extremely important to ensure that the correct
samples are grouped together for comparisons.</p>
<pre class="r"><code>all(colnames(count_table) == rownames(samplesheet))</code></pre>
<pre><code>[1] TRUE</code></pre>
<p>This line of code checks if both the identity and order match between
our <code>count_table</code> and our <code>samplesheet</code>. If, in
the course of using your own data, this ever returns <code>FALSE</code>,
try using the <code>match()</code> function to rearrange the columns of
<code>count_table</code> (or the rows of <code>samplesheet</code>) to
get them to match.</p>
<p><strong>Checkpoint</strong>: <em>If you your sample info check
returns <code>TRUE</code>, please indicate with the green ‘yes’ button.
Otherwise, please use the red ‘x’ button to have the command
repeated</em></p>
</div>
</div>
<div id="creating-deseq2-object" class="section level1">
<h1>Creating DESeq2 object</h1>
<p>To create the <code>DESeqDataSet</code> we will need the
<code>count_table</code> and the <code>samplesheet</code>. We will also
need a <strong>design formula</strong> to specify our model.</p>
<div id="making-model-choices" class="section level2">
<h2>Making model choices</h2>
<p>The design formula specified informs many of the DESeq2 functions how
to treat the samples in the analysis, specifically which column in the
samaple metadata table contains the experimental design.</p>
<p>In this case, we aren’t aware of any <a
href="https://methods-sagepub-com.proxy.lib.umich.edu/reference/encyc-of-research-design/n85.xml"><strong>covariates</strong></a>
that should be considered in our comparisons. However, if there are
additional attributes of the samples that may impact the DE comparisons,
like sex, date of collection, or patient of origin, these should be
added as <a href="https://support.bioconductor.org/p/75309/">additional
columns</a> in the sample information table and <a
href="https://support.bioconductor.org/p/98700/">added to a design
formula</a>.</p>
<details>
<summary>
<em>Click for Note</em>
</summary>
More complex questions, including determining if a fold-change due to
treatment is different across groups, such as patient samples,
“interaction terms” can be included in the design formula, such as
outlined in <a href="https://support.bioconductor.org/p/98628/">this
support thread</a>.
</details>
<p>The design formula specifies the column(s) in the metadata table and
how they should be used in the analysis. For our dataset we only have
one column we are interested in, that is <code>condition</code>. This
column has three factor levels, which tells DESeq2 that for each gene we
want to evaluate gene expression change with respect to these different
levels.</p>
<pre class="r"><code>## Create DESeq object, line by line
dds = DESeqDataSetFromMatrix(countData = count_table,
                              colData = samplesheet,
                              design = ~ condition)</code></pre>
<pre><code>converting counts to integer mode</code></pre>
<pre class="r"><code>dds</code></pre>
<pre><code>class: DESeqDataSet 
dim: 55492 6 
metadata(1): version
assays(1): counts
rownames(55492): ENSMUSG00000000001 ENSMUSG00000000003 ... mcherry tdtomato
rowData names(0):
colnames(6): SRR7777895 SRR7777896 ... SRR7777899 SRR7777900
colData names(2): genotype condition</code></pre>
<p>Notice that printing the <code>dds</code> object helpfully shows us
some helpful information:</p>
<ul>
<li>The dimension (number of genes by number of samples),</li>
<li>The gene identifiers,</li>
<li>The sample identifiers,</li>
<li>The additional column names giving information about the
samples</li>
</ul>
<p><strong>Checkpoint</strong>: <em>If you see <code>dds</code> in your
environment panel, please indicate with the green ‘check’ button.
Otherwise, please use use the red ‘x’ button in your zoom reaction panel
to have this step repeated. You can use the red ‘x’ to be put in a
breakout room for help</em></p>
<details>
<summary>
<em>Click for how to model batch effects with DESeq2</em>
</summary>
<p>Differences between samples can also be due to technical reasons,
such as collection on different days or different sequencing runs.
Differences between samples that are not due to biological factors as
called <strong>batch effects</strong>. We can include batch effects in
our design model in the same way as covariates, as long as the technical
groups do not overlap, or <strong>confound</strong>, the biological
treatment groups. Let’s try add some additional meta-data information
where we have counfounding batch effects and create another DESeq2
object.</p>
<pre class="r"><code>#samplesheet
samplesheet$batch = factor(c(rep(c(&quot;Day1&quot;), 3),
                       rep(c(&quot;Day2&quot;), 3),
                       rep(c(&quot;Day3&quot;), 3),
                       rep(c(&quot;Day4&quot;), 3)),
                     levels = c(&quot;Day1&quot;, &quot;Day2&quot;, &quot;Day3&quot;, &quot;Day4&quot;))

dds_batch = DESeqDataSetFromMatrix(countData = count_table,
                      colData = samplesheet,
                      design = ~ batch + condition)</code></pre>
Notice that if you run the above command, the error indicates that
variables in the design formula “are linear combinations” which means
that batch and condition are correlated and the function is unable to
fill in a required ‘slot’ in the DESeq2 object. So if batches are
<strong>not balanced</strong> by including both case and controls (like
in the patient covariate example) then we cannot control for those
technical effects through statistical modeling.
</details>
<hr />
</div>
</div>
<div id="pre-filtering" class="section level1">
<h1>Pre-filtering</h1>
<p>While not necessary, <a
href="http://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html#pre-filtering">pre-filtering</a>
the count table helps to not only reduce the size of the DESeq2 object,
but also gives you a sense of how many genes were reasonably measured at
the sequencing depth generated for your samples.</p>
<p>Here we will filter out any genes that have less than 10 counts
across any of the samples. This is a fairly standard level of filtering,
but can filter data less/more depending on quality control metrics from
alignments and sequencing depth or total number of samples.</p>
<pre class="r"><code>keep = rowSums(counts(dds)) &gt;= 10
dds = dds[keep,]
dds</code></pre>
<pre><code>class: DESeqDataSet 
dim: 16249 6 
metadata(1): version
assays(1): counts
rownames(16249): ENSMUSG00000000001 ENSMUSG00000000028 ... ENSMUSG00000118651 ENSMUSG00000118653
rowData names(0):
colnames(6): SRR7777895 SRR7777896 ... SRR7777899 SRR7777900
colData names(2): genotype condition</code></pre>
<p>Notice the <code>dds</code> object has less elements after filtering.
There were quite a number of genes that were not measured in our
experiment.</p>
<p><strong>Checkpoint</strong>: <em>Questions?</em></p>
<div id="optional-exercise-adding-covariates-to-sample-information"
class="section level4 unlisted unnumbered">
<h4 class="unlisted unnumbered">[Optional exercise]: Adding covariates
to sample information</h4>
<p>You can test out manually adding a covariate to our
<code>samplesheet</code> data table and then create a new DESeq2
object.</p>
<details>
<summary>
<em>Click for how to add a covariate to sample information</em>
</summary>
<pre class="r"><code>head(samplesheet)
samplesheet$patient = factor(rep(c(&quot;P1&quot;, &quot;P2&quot;, &quot;P3&quot;), 4), levels = c(&quot;P1&quot;, &quot;P2&quot;, &quot;P3&quot;))
head(samplesheet)</code></pre>
<p>Notice how we avoid starting with a number our patient covariate
labels since R doesn’t like that.</p>
<pre class="r"><code>dds_patient = DESeqDataSetFromMatrix(countData = count_table,
                          colData = samplesheet,
                          design = ~ patient + condition)</code></pre>
Now we have specified for DESeq2 that we want to test for the effect of
the condition (the last factor) while controlling for the effect of the
patient origin (the first factor).
</details>
</div>
</div>
<div id="summary" class="section level1">
<h1>Summary</h1>
<p>In this section, we:</p>
<ul>
<li>Loaded the necessary input files into our R session</li>
<li>Discussed model design for DESeq2</li>
<li>Initialized a DESeq2 data set</li>
<li>Filtered our count data</li>
</ul>
<p>Now that we’ve created our DESeq2 objects, including specifying what
model is appropriate for our data, and filtered our data, we can proceed
with assessing the impact of the experimental conditions on gene
expression across our samples.</p>
<hr />
</div>
<div id="sources" class="section level1">
<h1>Sources</h1>
<p>Training resources used to develop materials:</p>
<ul>
<li>HBC DGE setup: <a
href="https://hbctraining.github.io/DGE_workshop/lessons/01_DGE_setup_and_overview.html"
class="uri">https://hbctraining.github.io/DGE_workshop/lessons/01_DGE_setup_and_overview.html</a></li>
<li>HBC Count Normalization: <a
href="https://hbctraining.github.io/DGE_workshop/lessons/02_DGE_count_normalization.html"
class="uri">https://hbctraining.github.io/DGE_workshop/lessons/02_DGE_count_normalization.html</a></li>
<li>DESeq2 standard vignette: <a
href="http://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html"
class="uri">http://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html</a></li>
<li>DESeq2 beginners vignette: <a
href="https://bioc.ism.ac.jp/packages/2.14/bioc/vignettes/DESeq2/inst/doc/beginner.pdf"
class="uri">https://bioc.ism.ac.jp/packages/2.14/bioc/vignettes/DESeq2/inst/doc/beginner.pdf</a></li>
<li>Bioconductor RNA-seq Workflows: <a
href="https://www.bioconductor.org/help/course-materials/2015/LearnBioconductorFeb2015/B02.1_RNASeq.html"
class="uri">https://www.bioconductor.org/help/course-materials/2015/LearnBioconductorFeb2015/B02.1_RNASeq.html</a></li>
<li>CCDL Gastric cancer training materials: <a
href="https://alexslemonade.github.io/training-modules/RNA-seq/03-gastric_cancer_exploratory.nb.html"
class="uri">https://alexslemonade.github.io/training-modules/RNA-seq/03-gastric_cancer_exploratory.nb.html</a></li>
<li>CCDL Neuroblastoma training materials: <a
href="https://alexslemonade.github.io/training-modules/RNA-seq/05-nb_cell_line_DESeq2.nb.html"
class="uri">https://alexslemonade.github.io/training-modules/RNA-seq/05-nb_cell_line_DESeq2.nb.html</a></li>
</ul>
<hr />
<p>These materials have been adapted and extended from materials listed
above. These are open access materials distributed under the terms of
the <a href="http://creativecommons.org/licenses/by/4.0/">Creative
Commons Attribution license (CC BY 4.0)</a>, which permits unrestricted
use, distribution, and reproduction in any medium, provided the original
author and source are credited.</p>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiTW9kdWxlIDA3OiBERVNlcTIgSW5pdGlhbGl6YXRpb24iCmF1dGhvcjogIlVNIEJpb2luZm9ybWF0aWNzIENvcmUiCmRhdGU6ICJgciBTeXMuRGF0ZSgpYCIKb3V0cHV0OgogICAgICAgIGh0bWxfZG9jdW1lbnQ6CiAgICAgICAgICAgIGluY2x1ZGVzOgogICAgICAgICAgICAgICAgaW5faGVhZGVyOiBoZWFkZXIuaHRtbAogICAgICAgICAgICB0aGVtZTogcGFwZXIKICAgICAgICAgICAgdG9jOiB0cnVlCiAgICAgICAgICAgIHRvY19kZXB0aDogNAogICAgICAgICAgICB0b2NfZmxvYXQ6IHRydWUKICAgICAgICAgICAgbnVtYmVyX3NlY3Rpb25zOiBmYWxzZQogICAgICAgICAgICBmaWdfY2FwdGlvbjogdHJ1ZQogICAgICAgICAgICBtYXJrZG93bjogR0ZNCiAgICAgICAgICAgIGNvZGVfZG93bmxvYWQ6IHRydWUKLS0tCgo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPgpib2R5LCB0ZCB7CiAgIGZvbnQtc2l6ZTogMThweDsKfQpjb2RlLnJ7CiAgZm9udC1zaXplOiAxMnB4Owp9CnByZSB7CiAgZm9udC1zaXplOiAxMnB4Cn0KPC9zdHlsZT4KCmBgYHtyLCBpbmNsdWRlID0gRkFMU0V9CnNvdXJjZSgiLi4vYmluL2NodW5rLW9wdGlvbnMuUiIpCmtuaXRyX2ZpZ19wYXRoKCIwNy0iKQpgYGAKCj4gIyBPYmplY3RpdmVzIHsudW5saXN0ZWQgLnVubnVtYmVyZWR9Cj4gKiAnVW5ibGluZCcgb3VyIHNhbXBsZSBJRHMKPiAqIFVuZGVyc3RhbmQgcG9zc2libGUgY29uZm91bmRpbmcgZmFjdG9ycwo+ICogVW5kZXJzdGFuZCB0aGUgaW1wYWN0IG9mIGJhdGNoZXMgb3IgYWRkaXRpb25hbCBjb3ZhcmlhdGVzCj4gKiBGaWx0ZXIgY291bnQgdGFibGUKCmBgYHtyIExvYWRSdW5uaW5nRGF0YSwgZXZhbD1UUlVFLCBlY2hvPUZBTFNFLCBtZXNzYWdlPUZBTFNFLCB3YXJuaW5nPUZBTFNFfQpsaWJyYXJ5KERFU2VxMikKbG9hZCgicmRhdGEvUnVubmluZ0RhdGEuUkRhdGEiKQpgYGAKCgojIERpZmZlcmVudGlhbCBFeHByZXNzaW9uIFdvcmtmbG93CgpIZXJlIHdlIHdpbGwgcHJvY2VlZCBzZXR0aW5nIHVwIHRoZSBpbnB1dHMgbmVlZGVkIHRvIGluaXRpYWxpemUgREVTZXEyIGJlZm9yZSB0ZXN0aW5nIGZvciBkaWZmZXJlbnRpYWwgZXhwcmVzc2lvbi4KCiFbXSguL2ltYWdlcy93YXlmaW5kZXIvd2F5ZmluZGVyLTA3LnBuZyl7d2lkdGg9NzUlfQoKLS0tCgojIERFU2VxMiBvYmplY3RzCgpCaW9jb25kdWN0b3Igc29mdHdhcmUgcGFja2FnZXMgb2Z0ZW4gZGVmaW5lIGFuZCB1c2UgY3VzdG9tIGNsYXNzZXMgd2l0aGluIFIgdG8gc3RvcmUgZGF0YSBpbiBhIHdheSB0aGF0IGJldHRlciBmaXRzIGV4cGVjdGF0aW9ucyBhcm91bmQgYmlvbG9naWNhbCBkYXRhLCBzdWNoIGFzIGlsbHVzdHJhdGVkIGJlbG93IGZyb20gW0h1YmVyIGV0IGFsLiAyMDE1XShodHRwczovL3d3dy5uYXR1cmUuY29tL2FydGljbGVzL25tZXRoLjMyNTIpLgoKIVtdKC4vaW1hZ2VzL1N1bW1hcml6ZWRFeHBlcmltZW50LmpwZykKClRoZXNlIGN1c3RvbSBkYXRhIHN0cnVjdHVyZXMgaGF2ZSBwcmUtc3BlY2lmaWVkIGRhdGEgc2xvdHMsIHdoaWNoIGhvbGQgc3BlY2lmaWMgdHlwZXMvY2xhc3NlcyBvZiBkYXRhIGFuZCB0aGVyZWZvcmUgY2FuIGJlIG1vcmUgZWFzaWx5IGFjY2Vzc2VkIGJ5IGZ1bmN0aW9ucyBmcm9tIHRoZSBzYW1lIHBhY2thZ2UuCgpUbyBjcmVhdGUgdGhlIERFU2VxRGF0YVNldCB3ZSBuZWVkIHR3byB0YWJsZXM6CgoxLiBhIGNvdW50IG1hdHJpeCAod2hpY2ggd2UgYWxyZWFkeSBsb2FkZWQpCjIuIGEgdGFibGUgdGhhdCBhc3NpZ25zIHRoZSBjb25kaXRpb24gbGFiZWxzIGZvciBlYWNoIHNhbXBsZSAod2hpY2ggd2Ugd2lsbCBnZW5lcmF0ZSBiZWxvdykuCgoKIyBTYW1wbGUgSW5mb3JtYXRpb24KCkZvciB0aGlzIHJlcHJlc2VudGF0aXZlIGRhdGFzZXQsIHdlIGhhdmUgc29tZXdoYXQgbGltaXRlZCBpbmZvcm1hdGlvbiBmcm9tIFtwdWJsaWMgcmVjb3Jkc10oaHR0cHM6Ly93d3cubmNiaS5ubG0ubmloLmdvdi9nZW8vcXVlcnkvYWNjLmNnaT9hY2M9R1NFMTQ0NTg4KSwgYnV0IHdlIGtub3cgdGhlc2Ugc2FtcGxlcyB3ZXJlIGlzb2xhdGVkIGZyb20gZWl0aGVyIHdpbGQtdHlwZSBvciBrbm9jay1vdXQgVC1jZWxscyBoYXJ2ZXN0ZWQgZnJvbSBjb250cm9sIG1pY2Ugb3IgaXNvbGF0ZWQgZnJvbSBwcmV2aW91c2x5IHRyYW5zcGxhbnRlZCBtaWNlLgoKIyMgR2VuZXJhdGUgU2FtcGxlIFRhYmxlCgpPdXIgbmV4dCBzdGVwIHdpbGwgYmUgdG8gZGVzY3JpYmUgdGhlIHNhbXBsZXMgd2l0aGluIG91ciBSIHNlc3Npb24sIHNvIHRoYXQgd2UgbWFrZSB0aGUgcHJvcGVyIGNvbXBhcmlzb25zIHdpdGggREVTZXEyLiBUaGUgZmlyc3Qgc3RlcCBpcyB0byBjaGVjayB0aGUgc2FtcGxlIG5hbWVzIGZyb20gdGhlIGNvdW50IHRhYmxlLgpgYGB7ciBDb2x1bW5OYW1lc30KY29sbmFtZXMoY291bnRfdGFibGUpCmBgYAoKV2hlbiB3ZSBsb29rZWQgYXQgb3VyIGBjb3VudF90YWJsZWAsIG91ciBzYW1wbGVzIGFyZSBibGluZGVkLCBlLmcuIHRoZSBzYW1wbGUgbmFtZXMgZG9uJ3QgY29ycmVzcG9uZCB0byBhbnkgb2YgdGhlIGV4cGVjdGVkIHRyZWF0bWVudCBncm91cHMuIFNvIHdlIHdpbGwgbmVlZCB0byBzcGVjaWZ5IHdoaWNoIHNhbXBsZSBJRHMgY29ubmVjdCB0byB3aGljaCBleHBlcmltZW50YWwgY29uZGl0aW9ucy4KClNpbmNlIHRoZXJlIGFyZSBhIGxhcmdlIG51bWJlciBvZiBzYW1wbGVzIChhbmQgdG8gaW5jcmVhc2UgdGhlIHJlcHJvZHVjaWJsaXR5IG9mIG91ciBjb2RlKSwgd2Ugd291bGQgZ2VuZXJhdGUgYSBzYW1wbGUgaW5mb3JtYXRpb24gdGFibGUgaW4gZXhjZWwgYW5kIGV4cG9ydGVkIGl0IGFzIGEgJy5jc3YnIGZpbGUgc28gdGhhdCBpdCBpcyBpbiBhICdwbGFpbiB0ZXh0JyBmb3JtYXQgdGhhdCBjYW4gYmUgZWFzaWx5IGxvYWRlZCBpbnRvIG91ciBSIHNlc3Npb24uCgoKPGRldGFpbHM+CiAgICA8c3VtbWFyeT4qQ2xpY2sgZm9yIHNhbXBsZSBuYW1pbmcgY29udmVudGlvbnMqPC9zdW1tYXJ5PgogICAgQSBjcml0aWNhbCBhc3BlY3Qgb2YgY3JlYXRpbmcgYSBzYW1wbGUgc2hlZXQgaW4gZXhjZWwgaXMgdG8gYXZvaWQgdXNpbmcgc3BhY2VzIG9yIGNoYXJhY3RlcnMgdGhhdCBoYXZlIHNwZWNpYWwgdXNlcyBpbiBSLCBzdWNoIGFzIGRhc2hlcyBvciBwYXJlbnRoZXNlcy4gU2ltcGxlIHNhbXBsZSBncm91cCBuYW1lcyBhcmUgYmVzdC4KICAgIElmIHlvdSBhcmUgdW5mYW1pbGFyIHdpdGggJy5jc3YnIGZpbGVzIG9yIGhvdyB0byBnZW5lcmF0ZSB0aGVtLCB0aGVyZSBhcmUgW3R1dG9yaWFsc10oaHR0cHM6Ly93d3cud2lraWhvdy5jb20vQ3JlYXRlLWEtQ1NWLUZpbGUpIGF2YWlsYWJsZSB0byBndWlkZSB5b3UgdGhyb3VnaCB0aGUgcHJvY2Vzcy4KCjwvZGV0YWlscz4KCldlJ2xsIGxvYWQgb3VyICdwcmUtbWFkZScgc2FtcGxlIGluZm9ybWF0aW9uIHNoZWV0LCBgc2FtcGxlc2hlZXQuY3N2YCwgdG8gdW5ibGluZCBvdXIgc2FtcGxlcy4KCmBgYHtyIFNhbXBsZXNoZWV0LCBlY2hvID0gRkFMU0UsIGV2YWwgPSBUUlVFfQpzYW1wbGVzaGVldCA9IHJlYWQudGFibGUoIi4uL2RhdGEvc2FtcGxlc2hlZXQuY3N2IiwKICAgICAgICAgICAgICAgICAgICAgICBzZXAgPSAiLCIsCiAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyID0gVFJVRSwKICAgICAgICAgICAgICAgICAgICAgICByb3cubmFtZXMgPSAxKQpgYGAKCmBgYHtyIFNhbXBsZXNoZWV0MiwgZXZhbCA9IEZBTFNFfQpzYW1wbGVzaGVldCA9IHJlYWQudGFibGUoImRhdGEvc2FtcGxlc2hlZXQuY3N2IiwKICAgICAgICAgICAgICAgICAgICAgICBzZXAgPSAiLCIsCiAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyID0gVFJVRSwKICAgICAgICAgICAgICAgICAgICAgICByb3cubmFtZXMgPSAxKQpgYGAKCmBgYHtyIFNob3dTYW1wbGVzaGVldH0Kc2FtcGxlc2hlZXQKYGBgCgoqKkNoZWNrcG9pbnQqKjogKklmIHlvdSBoYXZlIGxvYWRlZCBgc2FtcGxlc2hlZXRgLCBwbGVhc2UgaW5kaWNhdGUgd2l0aCB0aGUgZ3JlZW4gJ2NoZWNrJyBidXR0b24uIE90aGVyd2lzZSwgcGxlYXNlIHVzZSB0aGUgcmVkICd4JyBidXR0b24gdG8gaGF2ZSB0aGUgY29tbWFuZCByZXBlYXRlZCoKCkhvdyBhcmUgdGhlIHRyZWF0bWVudCBncm91cHMgZW5jb2RlZCBpbiB0aGUgdGFibGUgd2UganVzdCBsb2FkZWQ/CgpgYGB7ciBUcmVhdG1lbnRHcm91cFRhYmxlfQp1bmlxdWUoc2FtcGxlc2hlZXQkY29uZGl0aW9uKQpgYGAKCk5leHQsIHdlJ2xsIGZvcm1hdCBvdXIgdGFibGUgc28gdGhhdCB3ZSBoYXZlIHRoZSBhcHByb3ByaWF0ZSBkYXRhIHR5cGUgKGFuIG9yZGVyZWQgW2ZhY3Rvcl0oaHR0cHM6Ly9zd2NhcnBlbnRyeS5naXRodWIuaW8vci1ub3ZpY2UtaW5mbGFtbWF0aW9uLzEyLXN1cHAtZmFjdG9ycy8pKSBmb3IgREVTZXEyIHRvIHJlY29nbml6ZSBvdXIgdHJlYXRtZW50IGdyb3VwcyBhbmQgYXBwcm9wcmlhdGVseSBjb21wYXJlIHNhbXBsZXMuCgpgYGB7ciBTYW1wbGVzaGVldEZhY3Rvcn0KCnNhbXBsZXNoZWV0JGNvbmRpdGlvbiA9IGZhY3RvcihzYW1wbGVzaGVldCRjb25kaXRpb24sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXZlbHMgPSBjKCdtaW51cycsICdwbHVzJykpCgp1bmlxdWUoc2FtcGxlc2hlZXQkY29uZGl0aW9uKQpgYGAKCk5vdGljZSB0aGF0IHdlIHNldCB0aGUgbGV2ZWxzIGluIGEgcGFydGljdWxhciBvcmRlci4gVGhpcyBpcyBpbXBvcnRhbnQgZm9yIHNldHRpbmcgdGhlICdDb250cm9sJyBncm91cCBhcyB0aGUgZGVub21pbmF0b3IgaW4gb3VyIGNvbXBhcmlzb25zIHdoZW4gd2Ugc2V0dXAgb3VyIERFU2VxMiBtb2RlbC4gVGhlICdDYXNlJyBuYW1lIHNob3VsZCBiZSBsYXN0IGlmIHRoZXJlIGFyZSBvbmx5IHR3byBncm91cHMgJiBmaXJzdCBpZiB0aGVyZSBhcmUgb25seSB0aHJlZSBncm91cHMgdG8gZ2VuZXJhdGUgZGVmYXVsdCBwYWlyLXdpc2UgY29tcGFyaXNvbnMuCgpCZWZvcmUgd2UgcHJvY2VlZCwgd2UgbmVlZCB0byBtYWtlIHN1cmUgdGhhdCB0aGUgc2FtcGxlIGxhYmVscyAoY29sdW1uIG5hbWVzKSBpbiB0aGUgY291bnQgdGFibGUgbWF0Y2ggdGhlIHNhbXBsZSBpbmZvcm1hdGlvbiB0YWJsZSAocm93IG5hbWVzKSwgaW5jbHVkaW5nIHRoZSBvcmRlci4KCklmIHRoZSBzYW1wbGUgbGFiZWxzIGRvbid0IG1hdGNoLCB0aGVuIHdlIHdpbGwgc2VlIGFuIGVycm9yIGFuZCBuZWVkIHRvIGNvcnJlY3QgdGhlIGxhYmVscyBwcmlvciB0byBwcm9jZWVkaW5nLiBDaGVja2luZyB0aGUgc2FtcGxlIGluZm9ybWF0aW9uIHRhYmxlIGlzIGV4dHJlbWVseSBpbXBvcnRhbnQgdG8gZW5zdXJlIHRoYXQgdGhlIGNvcnJlY3Qgc2FtcGxlcyBhcmUgZ3JvdXBlZCB0b2dldGhlciBmb3IgY29tcGFyaXNvbnMuCgpgYGB7ciBDaGVja1NhbXBsZXNoZWV0fQphbGwoY29sbmFtZXMoY291bnRfdGFibGUpID09IHJvd25hbWVzKHNhbXBsZXNoZWV0KSkKYGBgClRoaXMgbGluZSBvZiBjb2RlIGNoZWNrcyBpZiBib3RoIHRoZSBpZGVudGl0eSBhbmQgb3JkZXIgbWF0Y2ggYmV0d2VlbiBvdXIgYGNvdW50X3RhYmxlYCBhbmQgb3VyIGBzYW1wbGVzaGVldGAuIElmLCBpbiB0aGUgY291cnNlIG9mIHVzaW5nIHlvdXIgb3duIGRhdGEsIHRoaXMgZXZlciByZXR1cm5zIGBGQUxTRWAsIHRyeSB1c2luZyB0aGUgYG1hdGNoKClgIGZ1bmN0aW9uIHRvIHJlYXJyYW5nZSB0aGUgY29sdW1ucyBvZiBgY291bnRfdGFibGVgIChvciB0aGUgcm93cyBvZiBgc2FtcGxlc2hlZXRgKSB0byBnZXQgdGhlbSB0byBtYXRjaC4KCioqQ2hlY2twb2ludCoqOiAqSWYgeW91IHlvdXIgc2FtcGxlIGluZm8gY2hlY2sgcmV0dXJucyBgVFJVRWAsIHBsZWFzZSBpbmRpY2F0ZSB3aXRoIHRoZSBncmVlbiAneWVzJyBidXR0b24uIE90aGVyd2lzZSwgcGxlYXNlIHVzZSB0aGUgcmVkICd4JyBidXR0b24gdG8gaGF2ZSB0aGUgY29tbWFuZCByZXBlYXRlZCoKCiMgQ3JlYXRpbmcgREVTZXEyIG9iamVjdAoKVG8gY3JlYXRlIHRoZSBgREVTZXFEYXRhU2V0YCB3ZSB3aWxsIG5lZWQgdGhlIGBjb3VudF90YWJsZWAgYW5kIHRoZSBgc2FtcGxlc2hlZXRgLiBXZSB3aWxsIGFsc28gbmVlZCBhICoqZGVzaWduIGZvcm11bGEqKiB0byBzcGVjaWZ5IG91ciBtb2RlbC4KCiMjIE1ha2luZyBtb2RlbCBjaG9pY2VzCgpUaGUgZGVzaWduIGZvcm11bGEgc3BlY2lmaWVkIGluZm9ybXMgbWFueSBvZiB0aGUgREVTZXEyIGZ1bmN0aW9ucyBob3cgdG8gdHJlYXQgdGhlIHNhbXBsZXMgaW4gdGhlIGFuYWx5c2lzLCBzcGVjaWZpY2FsbHkgd2hpY2ggY29sdW1uIGluIHRoZSBzYW1hcGxlIG1ldGFkYXRhIHRhYmxlIGNvbnRhaW5zIHRoZSBleHBlcmltZW50YWwgZGVzaWduLgoKSW4gdGhpcyBjYXNlLCB3ZSBhcmVuJ3QgYXdhcmUgb2YgYW55IFsqKmNvdmFyaWF0ZXMqKl0oaHR0cHM6Ly9tZXRob2RzLXNhZ2VwdWItY29tLnByb3h5LmxpYi51bWljaC5lZHUvcmVmZXJlbmNlL2VuY3ljLW9mLXJlc2VhcmNoLWRlc2lnbi9uODUueG1sKSB0aGF0IHNob3VsZCBiZSBjb25zaWRlcmVkIGluIG91ciBjb21wYXJpc29ucy4gSG93ZXZlciwgaWYgdGhlcmUgYXJlIGFkZGl0aW9uYWwgYXR0cmlidXRlcyBvZiB0aGUgc2FtcGxlcyB0aGF0IG1heSBpbXBhY3QgdGhlIERFIGNvbXBhcmlzb25zLCBsaWtlIHNleCwgZGF0ZSBvZiBjb2xsZWN0aW9uLCBvciBwYXRpZW50IG9mIG9yaWdpbiwgdGhlc2Ugc2hvdWxkIGJlIGFkZGVkIGFzIFthZGRpdGlvbmFsIGNvbHVtbnNdKGh0dHBzOi8vc3VwcG9ydC5iaW9jb25kdWN0b3Iub3JnL3AvNzUzMDkvKSBpbiB0aGUgc2FtcGxlIGluZm9ybWF0aW9uIHRhYmxlIGFuZCBbYWRkZWQgdG8gYSBkZXNpZ24gZm9ybXVsYV0oaHR0cHM6Ly9zdXBwb3J0LmJpb2NvbmR1Y3Rvci5vcmcvcC85ODcwMC8pLgoKCjxkZXRhaWxzPgogICAgPHN1bW1hcnk+KkNsaWNrIGZvciBOb3RlKjwvc3VtbWFyeT4KICAgIE1vcmUgY29tcGxleCBxdWVzdGlvbnMsIGluY2x1ZGluZyBkZXRlcm1pbmluZyBpZiBhIGZvbGQtY2hhbmdlIGR1ZSB0byB0cmVhdG1lbnQgaXMgZGlmZmVyZW50IGFjcm9zcyBncm91cHMsIHN1Y2ggYXMgcGF0aWVudCBzYW1wbGVzLCAiaW50ZXJhY3Rpb24gdGVybXMiIGNhbiBiZSBpbmNsdWRlZCBpbiB0aGUgZGVzaWduIGZvcm11bGEsIHN1Y2ggYXMgb3V0bGluZWQgaW4gW3RoaXMgc3VwcG9ydCB0aHJlYWRdKGh0dHBzOi8vc3VwcG9ydC5iaW9jb25kdWN0b3Iub3JnL3AvOTg2MjgvKS4KPC9kZXRhaWxzPgoKVGhlIGRlc2lnbiBmb3JtdWxhIHNwZWNpZmllcyB0aGUgY29sdW1uKHMpIGluIHRoZSBtZXRhZGF0YSB0YWJsZSBhbmQgaG93IHRoZXkgc2hvdWxkIGJlIHVzZWQgaW4gdGhlIGFuYWx5c2lzLiBGb3Igb3VyIGRhdGFzZXQgd2Ugb25seSBoYXZlIG9uZSBjb2x1bW4gd2UgYXJlIGludGVyZXN0ZWQgaW4sIHRoYXQgaXMgYGNvbmRpdGlvbmAuIFRoaXMgY29sdW1uIGhhcyB0aHJlZSBmYWN0b3IgbGV2ZWxzLCB3aGljaCB0ZWxscyBERVNlcTIgdGhhdCBmb3IgZWFjaCBnZW5lIHdlIHdhbnQgdG8gZXZhbHVhdGUgZ2VuZSBleHByZXNzaW9uIGNoYW5nZSB3aXRoIHJlc3BlY3QgdG8gdGhlc2UgZGlmZmVyZW50IGxldmVscy4KCmBgYHtyIERFU2VxMk9iamVjdH0KIyMgQ3JlYXRlIERFU2VxIG9iamVjdCwgbGluZSBieSBsaW5lCmRkcyA9IERFU2VxRGF0YVNldEZyb21NYXRyaXgoY291bnREYXRhID0gY291bnRfdGFibGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbERhdGEgPSBzYW1wbGVzaGVldCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzaWduID0gfiBjb25kaXRpb24pCmRkcwpgYGAKCk5vdGljZSB0aGF0IHByaW50aW5nIHRoZSBgZGRzYCBvYmplY3QgaGVscGZ1bGx5IHNob3dzIHVzIHNvbWUgaGVscGZ1bCBpbmZvcm1hdGlvbjoKCiogVGhlIGRpbWVuc2lvbiAobnVtYmVyIG9mIGdlbmVzIGJ5IG51bWJlciBvZiBzYW1wbGVzKSwKKiBUaGUgZ2VuZSBpZGVudGlmaWVycywKKiBUaGUgc2FtcGxlIGlkZW50aWZpZXJzLAoqIFRoZSBhZGRpdGlvbmFsIGNvbHVtbiBuYW1lcyBnaXZpbmcgaW5mb3JtYXRpb24gYWJvdXQgdGhlIHNhbXBsZXMKCioqQ2hlY2twb2ludCoqOiAqSWYgeW91IHNlZSBgZGRzYCBpbiB5b3VyIGVudmlyb25tZW50IHBhbmVsLCBwbGVhc2UgaW5kaWNhdGUgd2l0aCB0aGUgZ3JlZW4gJ2NoZWNrJyBidXR0b24uIE90aGVyd2lzZSwgcGxlYXNlIHVzZSAgdXNlIHRoZSByZWQgJ3gnIGJ1dHRvbiBpbiB5b3VyIHpvb20gcmVhY3Rpb24gcGFuZWwgdG8gaGF2ZSB0aGlzIHN0ZXAgcmVwZWF0ZWQuIFlvdSBjYW4gdXNlIHRoZSByZWQgJ3gnIHRvIGJlIHB1dCBpbiBhIGJyZWFrb3V0IHJvb20gZm9yIGhlbHAqCgo8ZGV0YWlscz4KICAgIDxzdW1tYXJ5PipDbGljayBmb3IgaG93IHRvIG1vZGVsIGJhdGNoIGVmZmVjdHMgd2l0aCBERVNlcTIqPC9zdW1tYXJ5PgogICAgRGlmZmVyZW5jZXMgYmV0d2VlbiBzYW1wbGVzIGNhbiBhbHNvIGJlIGR1ZSB0byB0ZWNobmljYWwgcmVhc29ucywgc3VjaCBhcyBjb2xsZWN0aW9uIG9uIGRpZmZlcmVudCBkYXlzIG9yIGRpZmZlcmVudCBzZXF1ZW5jaW5nIHJ1bnMuIERpZmZlcmVuY2VzIGJldHdlZW4gc2FtcGxlcyB0aGF0IGFyZSBub3QgZHVlIHRvIGJpb2xvZ2ljYWwgZmFjdG9ycyBhcyBjYWxsZWQgKipiYXRjaCBlZmZlY3RzKiouIFdlIGNhbiBpbmNsdWRlIGJhdGNoIGVmZmVjdHMgaW4gb3VyIGRlc2lnbiBtb2RlbCBpbiB0aGUgc2FtZSB3YXkgYXMgY292YXJpYXRlcywgYXMgbG9uZyBhcyB0aGUgdGVjaG5pY2FsIGdyb3VwcyBkbyBub3Qgb3ZlcmxhcCwgb3IgKipjb25mb3VuZCoqLCB0aGUgYmlvbG9naWNhbCB0cmVhdG1lbnQgZ3JvdXBzLgogICAgTGV0J3MgdHJ5IGFkZCBzb21lIGFkZGl0aW9uYWwgbWV0YS1kYXRhIGluZm9ybWF0aW9uIHdoZXJlIHdlIGhhdmUgY291bmZvdW5kaW5nIGJhdGNoIGVmZmVjdHMgYW5kIGNyZWF0ZSBhbm90aGVyIERFU2VxMiBvYmplY3QuCgpgYGB7ciBDb25mb3VuZGVycywgZXZhbD1GQUxTRX0KI3NhbXBsZXNoZWV0CnNhbXBsZXNoZWV0JGJhdGNoID0gZmFjdG9yKGMocmVwKGMoIkRheTEiKSwgMyksCiAgICAgICAgICAgICAgICAgICAgICAgcmVwKGMoIkRheTIiKSwgMyksCiAgICAgICAgICAgICAgICAgICAgICAgcmVwKGMoIkRheTMiKSwgMyksCiAgICAgICAgICAgICAgICAgICAgICAgcmVwKGMoIkRheTQiKSwgMykpLAogICAgICAgICAgICAgICAgICAgICBsZXZlbHMgPSBjKCJEYXkxIiwgIkRheTIiLCAiRGF5MyIsICJEYXk0IikpCgpkZHNfYmF0Y2ggPSBERVNlcURhdGFTZXRGcm9tTWF0cml4KGNvdW50RGF0YSA9IGNvdW50X3RhYmxlLAogICAgICAgICAgICAgICAgICAgICAgY29sRGF0YSA9IHNhbXBsZXNoZWV0LAogICAgICAgICAgICAgICAgICAgICAgZGVzaWduID0gfiBiYXRjaCArIGNvbmRpdGlvbikKYGBgCgogICAgTm90aWNlIHRoYXQgaWYgeW91IHJ1biB0aGUgYWJvdmUgY29tbWFuZCwgdGhlIGVycm9yIGluZGljYXRlcyB0aGF0IHZhcmlhYmxlcyBpbiB0aGUgZGVzaWduIGZvcm11bGEgImFyZSBsaW5lYXIgY29tYmluYXRpb25zIiB3aGljaCBtZWFucyB0aGF0IGJhdGNoIGFuZCBjb25kaXRpb24gYXJlIGNvcnJlbGF0ZWQgYW5kIHRoZSBmdW5jdGlvbiBpcyB1bmFibGUgdG8gZmlsbCBpbiBhIHJlcXVpcmVkICdzbG90JyBpbiB0aGUgREVTZXEyIG9iamVjdC4KICAgIFNvIGlmIGJhdGNoZXMgYXJlICoqbm90IGJhbGFuY2VkKiogYnkgaW5jbHVkaW5nIGJvdGggY2FzZSBhbmQgY29udHJvbHMgKGxpa2UgaW4gdGhlIHBhdGllbnQgY292YXJpYXRlIGV4YW1wbGUpIHRoZW4gd2UgY2Fubm90IGNvbnRyb2wgZm9yIHRob3NlIHRlY2huaWNhbCBlZmZlY3RzIHRocm91Z2ggc3RhdGlzdGljYWwgbW9kZWxpbmcuCjwvZGV0YWlscz4KCi0tLQoKCiMgUHJlLWZpbHRlcmluZwoKV2hpbGUgbm90IG5lY2Vzc2FyeSwgW3ByZS1maWx0ZXJpbmddKGh0dHA6Ly9iaW9jb25kdWN0b3Iub3JnL3BhY2thZ2VzL2RldmVsL2Jpb2MvdmlnbmV0dGVzL0RFU2VxMi9pbnN0L2RvYy9ERVNlcTIuaHRtbCNwcmUtZmlsdGVyaW5nKSB0aGUgY291bnQgdGFibGUgaGVscHMgdG8gbm90IG9ubHkgcmVkdWNlIHRoZSBzaXplIG9mIHRoZSBERVNlcTIgb2JqZWN0LCBidXQgYWxzbyBnaXZlcyB5b3UgYSBzZW5zZSBvZiBob3cgbWFueSBnZW5lcyB3ZXJlIHJlYXNvbmFibHkgbWVhc3VyZWQgYXQgdGhlIHNlcXVlbmNpbmcgZGVwdGggZ2VuZXJhdGVkIGZvciB5b3VyIHNhbXBsZXMuCgpIZXJlIHdlIHdpbGwgZmlsdGVyIG91dCBhbnkgZ2VuZXMgdGhhdCBoYXZlIGxlc3MgdGhhbiAxMCBjb3VudHMgYWNyb3NzIGFueSBvZiB0aGUgc2FtcGxlcy4gVGhpcyBpcyBhIGZhaXJseSBzdGFuZGFyZCBsZXZlbCBvZiBmaWx0ZXJpbmcsIGJ1dCBjYW4gZmlsdGVyIGRhdGEgbGVzcy9tb3JlIGRlcGVuZGluZyBvbiBxdWFsaXR5IGNvbnRyb2wgbWV0cmljcyBmcm9tIGFsaWdubWVudHMgYW5kIHNlcXVlbmNpbmcgZGVwdGggb3IgdG90YWwgbnVtYmVyIG9mIHNhbXBsZXMuCgpgYGB7ciBQcmVGaWx0ZXJ9CmtlZXAgPSByb3dTdW1zKGNvdW50cyhkZHMpKSA+PSAxMApkZHMgPSBkZHNba2VlcCxdCmRkcwpgYGAKCk5vdGljZSB0aGUgYGRkc2Agb2JqZWN0IGhhcyBsZXNzIGVsZW1lbnRzIGFmdGVyIGZpbHRlcmluZy4gVGhlcmUgd2VyZSBxdWl0ZSBhIG51bWJlciBvZiBnZW5lcyB0aGF0IHdlcmUgbm90IG1lYXN1cmVkIGluIG91ciBleHBlcmltZW50LgoKKipDaGVja3BvaW50Kio6ICpRdWVzdGlvbnM/KgoKIyMjIyBbT3B0aW9uYWwgZXhlcmNpc2VdOiBBZGRpbmcgY292YXJpYXRlcyB0byBzYW1wbGUgaW5mb3JtYXRpb24gey51bmxpc3RlZCAudW5udW1iZXJlZH0KCllvdSBjYW4gdGVzdCBvdXQgbWFudWFsbHkgYWRkaW5nIGEgY292YXJpYXRlIHRvIG91ciBgc2FtcGxlc2hlZXRgIGRhdGEgdGFibGUgYW5kIHRoZW4gY3JlYXRlIGEgbmV3IERFU2VxMiBvYmplY3QuCgo8ZGV0YWlscz4KICAgIDxzdW1tYXJ5PipDbGljayBmb3IgaG93IHRvIGFkZCBhIGNvdmFyaWF0ZSB0byBzYW1wbGUgaW5mb3JtYXRpb24qPC9zdW1tYXJ5PgoKYGBge3IgQ292YXJpYXRlcywgZXZhbD1GQUxTRX0KaGVhZChzYW1wbGVzaGVldCkKc2FtcGxlc2hlZXQkcGF0aWVudCA9IGZhY3RvcihyZXAoYygiUDEiLCAiUDIiLCAiUDMiKSwgNCksIGxldmVscyA9IGMoIlAxIiwgIlAyIiwgIlAzIikpCmhlYWQoc2FtcGxlc2hlZXQpCmBgYAoKICAgIE5vdGljZSBob3cgd2UgYXZvaWQgc3RhcnRpbmcgd2l0aCBhIG51bWJlciBvdXIgcGF0aWVudCBjb3ZhcmlhdGUgbGFiZWxzIHNpbmNlIFIgZG9lc24ndCBsaWtlIHRoYXQuCgpgYGB7ciBDb3ZhcmlhdGVERVNlcTJPYmplY3QsIGV2YWw9RkFMU0V9CmRkc19wYXRpZW50ID0gREVTZXFEYXRhU2V0RnJvbU1hdHJpeChjb3VudERhdGEgPSBjb3VudF90YWJsZSwKICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xEYXRhID0gc2FtcGxlc2hlZXQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzaWduID0gfiBwYXRpZW50ICsgY29uZGl0aW9uKQpgYGAKCiAgICBOb3cgd2UgaGF2ZSBzcGVjaWZpZWQgZm9yIERFU2VxMiB0aGF0IHdlIHdhbnQgdG8gdGVzdCBmb3IgdGhlIGVmZmVjdCBvZiB0aGUgY29uZGl0aW9uICh0aGUgbGFzdCBmYWN0b3IpIHdoaWxlIGNvbnRyb2xsaW5nIGZvciB0aGUgZWZmZWN0IG9mIHRoZSBwYXRpZW50IG9yaWdpbiAodGhlIGZpcnN0IGZhY3RvcikuCjwvZGV0YWlscz4KCiMgU3VtbWFyeQoKSW4gdGhpcyBzZWN0aW9uLCB3ZToKCiogTG9hZGVkIHRoZSBuZWNlc3NhcnkgaW5wdXQgZmlsZXMgaW50byBvdXIgUiBzZXNzaW9uCiogRGlzY3Vzc2VkIG1vZGVsIGRlc2lnbiBmb3IgREVTZXEyCiogSW5pdGlhbGl6ZWQgYSBERVNlcTIgZGF0YSBzZXQKKiBGaWx0ZXJlZCBvdXIgY291bnQgZGF0YQoKTm93IHRoYXQgd2UndmUgY3JlYXRlZCBvdXIgREVTZXEyIG9iamVjdHMsIGluY2x1ZGluZyBzcGVjaWZ5aW5nIHdoYXQgbW9kZWwgaXMgYXBwcm9wcmlhdGUgZm9yIG91ciBkYXRhLCBhbmQgZmlsdGVyZWQgb3VyIGRhdGEsIHdlIGNhbiBwcm9jZWVkIHdpdGggYXNzZXNzaW5nIHRoZSBpbXBhY3Qgb2YgdGhlIGV4cGVyaW1lbnRhbCBjb25kaXRpb25zIG9uIGdlbmUgZXhwcmVzc2lvbiBhY3Jvc3Mgb3VyIHNhbXBsZXMuCgotLS0KCiMgU291cmNlcwoKVHJhaW5pbmcgcmVzb3VyY2VzIHVzZWQgdG8gZGV2ZWxvcCBtYXRlcmlhbHM6CgoqIEhCQyBER0Ugc2V0dXA6IGh0dHBzOi8vaGJjdHJhaW5pbmcuZ2l0aHViLmlvL0RHRV93b3Jrc2hvcC9sZXNzb25zLzAxX0RHRV9zZXR1cF9hbmRfb3ZlcnZpZXcuaHRtbAoqIEhCQyBDb3VudCBOb3JtYWxpemF0aW9uOiBodHRwczovL2hiY3RyYWluaW5nLmdpdGh1Yi5pby9ER0Vfd29ya3Nob3AvbGVzc29ucy8wMl9ER0VfY291bnRfbm9ybWFsaXphdGlvbi5odG1sCiogREVTZXEyIHN0YW5kYXJkIHZpZ25ldHRlOiBodHRwOi8vYmlvY29uZHVjdG9yLm9yZy9wYWNrYWdlcy9kZXZlbC9iaW9jL3ZpZ25ldHRlcy9ERVNlcTIvaW5zdC9kb2MvREVTZXEyLmh0bWwKKiBERVNlcTIgYmVnaW5uZXJzIHZpZ25ldHRlOiBodHRwczovL2Jpb2MuaXNtLmFjLmpwL3BhY2thZ2VzLzIuMTQvYmlvYy92aWduZXR0ZXMvREVTZXEyL2luc3QvZG9jL2JlZ2lubmVyLnBkZgoqIEJpb2NvbmR1Y3RvciBSTkEtc2VxIFdvcmtmbG93czogaHR0cHM6Ly93d3cuYmlvY29uZHVjdG9yLm9yZy9oZWxwL2NvdXJzZS1tYXRlcmlhbHMvMjAxNS9MZWFybkJpb2NvbmR1Y3RvckZlYjIwMTUvQjAyLjFfUk5BU2VxLmh0bWwKKiBDQ0RMIEdhc3RyaWMgY2FuY2VyIHRyYWluaW5nIG1hdGVyaWFsczogaHR0cHM6Ly9hbGV4c2xlbW9uYWRlLmdpdGh1Yi5pby90cmFpbmluZy1tb2R1bGVzL1JOQS1zZXEvMDMtZ2FzdHJpY19jYW5jZXJfZXhwbG9yYXRvcnkubmIuaHRtbAoqIENDREwgTmV1cm9ibGFzdG9tYSB0cmFpbmluZyBtYXRlcmlhbHM6IGh0dHBzOi8vYWxleHNsZW1vbmFkZS5naXRodWIuaW8vdHJhaW5pbmctbW9kdWxlcy9STkEtc2VxLzA1LW5iX2NlbGxfbGluZV9ERVNlcTIubmIuaHRtbAoKCgpgYGB7ciBXcml0ZU91dC5SRGF0YSwgZXZhbD1UUlVFLCBlY2hvPUZBTFNFLCBtZXNzYWdlPUZBTFNFLCB3YXJuaW5nPUZBTFNFfQojSGlkZGVuIGNvZGUgYmxvY2sgdG8gd3JpdGUgb3V0IGRhdGEgZm9yIGtuaXR0aW5nCgpzYXZlLmltYWdlKGZpbGUgPSAicmRhdGEvUnVubmluZ0RhdGEuUkRhdGEiKQoKYGBgCgotLS0KClRoZXNlIG1hdGVyaWFscyBoYXZlIGJlZW4gYWRhcHRlZCBhbmQgZXh0ZW5kZWQgZnJvbSBtYXRlcmlhbHMgbGlzdGVkIGFib3ZlLiBUaGVzZSBhcmUgb3BlbiBhY2Nlc3MgbWF0ZXJpYWxzIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgW0NyZWF0aXZlIENvbW1vbnMgQXR0cmlidXRpb24gbGljZW5zZSAoQ0MgQlkgNC4wKV0oaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbGljZW5zZXMvYnkvNC4wLyksIHdoaWNoIHBlcm1pdHMgdW5yZXN0cmljdGVkIHVzZSwgZGlzdHJpYnV0aW9uLCBhbmQgcmVwcm9kdWN0aW9uIGluIGFueSBtZWRpdW0sIHByb3ZpZGVkIHRoZSBvcmlnaW5hbCBhdXRob3IgYW5kIHNvdXJjZSBhcmUgY3JlZGl0ZWQuCg==</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("Module07_DESeq2Init.Rmd");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
