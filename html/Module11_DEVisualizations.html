<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="UM Bioinformatics Core" />

<meta name="date" content="2022-08-04" />

<title>Module 11: DE Visualizations and Annotation</title>

<script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/paper.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link rel="shortcut icon" href="favicon-16x16.png" />
<!--
Favicon from
https://twemoji.twitter.com/
https://favicon.io/emoji-favicons/dna/
-->

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>




<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">RNA-Seq Demystified</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="Module00_Introduction.html">Intro</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Sequence QC
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module01_Warming_Up.html">Warming up</a>
    </li>
    <li>
      <a href="Module02a_QC.html">Quality Control</a>
    </li>
    <li>
      <a href="Module02b_Cutadapt_MoreQC.html">Cutadapt/MoreQC</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Alignment
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module03_Reference_Genomes.html">Reference Genomes</a>
    </li>
    <li>
      <a href="Module04_Alignment.html">Alignment/Quantification (STAR/RSEM)</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Quantification
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module05a_MultiQC_and_Count_Matrix.html">Count matrix / Alignment QC</a>
    </li>
    <li>
      <a href="Module05b_Additional_Details.html">Optional: Additional details</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Groups/Model
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module06_DEAnalysisSetup.html">Introduction to DESeq2</a>
    </li>
    <li>
      <a href="Module07_DESeq2Init.html">DESeq2 Initialization</a>
    </li>
    <li>
      <a href="Module08_DESeq2DE.html">Count Normalizations and DESeq2 model fitting</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Expression plots
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module09_SampleQCViz.html">Sample Visualizations for QC</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Diff Expression
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Module10_DEComparisons.html">Comparisons</a>
    </li>
    <li>
      <a href="Module11_DEVisualizations.html">DE Visiualization and Annotation</a>
    </li>
    <li>
      <a href="Module11X_BonusContent.html">Bonus content</a>
    </li>
  </ul>
</li>
<li>
  <a href="Module99_Wrap_up.html">Wrap up</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Module 11: DE Visualizations and
Annotation</h1>
<h4 class="author">UM Bioinformatics Core</h4>
<h4 class="date">2022-08-04</h4>

</div>


<style type="text/css">
body, td {
   font-size: 18px;
}
code.r{
  font-size: 12px;
}
pre {
  font-size: 12px
}
</style>
<blockquote>
<h1 id="objectives" class="unlisted unnumbered">Objectives</h1>
<ul>
<li>Understand advantages of using gene ids when analyzing data.</li>
<li>Given a list of ENSEMBL gene ids, add gene symbols and Entrez
accessions.</li>
<li>Generate common visualizations for differential expression
comparisons</li>
<li>Understand choosing thresholds for calling differentially expressed
genes</li>
<li>Discuss options for functional enrichments</li>
</ul>
</blockquote>
<div id="differential-expression-workflow" class="section level1">
<h1>Differential Expression Workflow</h1>
<p>Here we will generate summary figures for our results and annotate
our DE tables.</p>
<p><img src="images/wayfinder/wayfinder-11.png"
style="width:75.0%" /></p>
<p><strong>TODO: double check references to annotated table prior to
running annotations</strong></p>
<hr />
</div>
<div id="visualizing-de-results" class="section level1">
<h1>Visualizing DE results</h1>
<p>Part of differential expression analysis is generating visualizations
to share our results. While the DESeq2 tutorial provides <a
href="http://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html#exploring-and-exporting-results">examples
of other visualizations</a>, a common visualization to summarize DE
comparisons are <a
href="http://resources.qiagenbioinformatics.com/manuals/clcgenomicsworkbench/752/index.php?manual=Volcano_plots_inspecting_result_statistical_analysis.html">volcano
plots</a>.</p>
<div id="generating-volcano-plots" class="section level2">
<h2>Generating Volcano plots</h2>
<p>As described by this <a
href="https://galaxyproject.github.io/training-material/topics/transcriptomics/tutorials/rna-seq-viz-with-volcanoplot/tutorial.html">Galaxy
project tutorial</a>, a volcano plot is a type of scatterplot that shows
statistical significance (adjusted p-value) versus magnitude of change
(fold change). In a volcano plot, the most upregulated genes are towards
the right, the most downregulated genes are towards the left, and the
most statistically significant genes are towards the top.</p>
<p>First, we need to set thresholds for determining significant genes. A
reasonable threshold would be a fold-change of less than -1.5 or greater
than 1.5 and an adjusted pvalue less than 0.05.</p>
<pre class="r"><code>fc = 1.5
fdr = 0.05</code></pre>
<p>Next, we’ll set up an object on which we’ll use as the basis for our
plot. Let’s coerce the <code>DataFrame</code> which was returned into a
<code>tibble</code> and use some <code>tidyverse</code> functions to do
this:</p>
<pre class="r"><code># Let&#39;s first swing the rownames out as a column and coerce to a tibble
results_plus_vs_minus = as_tibble(results_plus_vs_minus, rownames = &#39;id&#39;) %&gt;% arrange(padj)

# Now let&#39;s save a copy to add columns for our plots
df = results_plus_vs_minus

comparison = &#39;plus_vs_minus&#39;</code></pre>
<p>Once we’ve setup the annotations we need, we can proceed with
generating the volcano plot, including our thresholds.</p>
<pre class="r"><code># Initialize the plot, saving as object &#39;p&#39; and specifying the plot type as &#39;geom_point&#39;
p = ggplot(df, aes(x = log2FoldChange, y = -log10(padj))) +
    geom_point(shape = 21, colour= &#39;darkgrey&#39;, size = 1) +
    theme_bw() +
    xlab(&#39;Log2 fold-change&#39;) + ylab(&#39;-Log10 adjusted p-value&#39;)

# Add threshold lines
p = p +
    geom_vline(
        xintercept = c(0, -log2(fc), log2(fc)),
        linetype = c(1, 2, 2)) +
    geom_hline(
        yintercept = -log10(fdr),
        linetype = 2)

# Add Title that includes comparison name
p = p + ggtitle(as.character(comparison))

# Display the plot in the plots pane of RStudio
p</code></pre>
<p><img src="fig/11-VolcanoPlot-1.png" width="816" style="display: block; margin: auto;" /></p>
<details>
<summary>
<em>Click for color coded volcano plot</em>
</summary>
<p>Now we need to <a
href="https://www.statmethods.net/management/subset.html">subset our
data</a> to label the datapoints (genes) that pass our thresholds.</p>
<pre class="r"><code>df$dot = rep(3, nrow(df))
df$dot[which(df$padj &lt;= fdr &amp; df$log2FoldChange &lt; 0 &amp; abs(df$log2FoldChange) &gt;= log2(fc))] = 2
df$dot[which(df$padj &lt;= fdr &amp; df$log2FoldChange &gt; 0 &amp; abs(df$log2FoldChange) &gt;= log2(fc))] = 1
df$sig = df$dot

#take top 5 up, down, then combine, assign label
top = rbind(head(subset(df, df$dot == 1), 5),head(subset(df, df$dot == 2), 5))
top$label = top$id
df = merge(x = df, y = top[,c(&#39;id&#39;,&#39;label&#39;)], by = &quot;id&quot;, all.x = TRUE)

#count the number of significan up and down genes, assign value for legend
df$dot = factor(df$dot,levels = c(1,2,3), labels = c(paste0(&#39;Up: &#39;, sum(df$dot == 1)),paste0(&#39;Down: &#39;, sum(df$dot == 2)),&#39;NS&#39;))</code></pre>
<p>Once we’ve setup the annotations we need, we can proceed with
generating the volcano plot.</p>
<pre class="r"><code>p = ggplot(df, aes(x = log2FoldChange, y = -log10(padj))) +
    geom_point(aes(color = df$dot), size = 1) +
    theme_classic() +
    xlab(&#39;Log2 fold-change&#39;) + ylab(&#39;-Log10 adjusted p-value&#39;)
# specify colors for up-/down-/nonsignificant genes
p = p + scale_color_manual(name = &#39;&#39;, values=c(&#39;#B31B21&#39;, &#39;#1465AC&#39;, &#39;darkgray&#39;))
# add threshol lines
p = p +
    geom_vline(
        xintercept = c(0, -log2(fc), log2(fc)),
        linetype = c(1, 2, 2),
        color = c(&#39;black&#39;, &#39;black&#39;, &#39;black&#39;)) +
    geom_hline(
        yintercept = -log10(fdr),
        linetype = 2,
        color = &#39;black&#39;)
# Add Title that includes comparison name
p = p + ggtitle(as.character(comparison))

p</code></pre>
<img src="fig/11-VolcanoPlot2-1.png" width="816" style="display: block; margin: auto;" />
</details>
<p><br></p>
<p>For additional visualizations for our DE results, we included some
example code in the Bonus Content module and this <a
href="https://hbctraining.github.io/DGE_workshop/lessons/06_DGE_visualizing_results.html">HBC
tutorial</a> includes some nice examples.</p>
</div>
<div id="summarizing-our-de-results" class="section level2">
<h2>Summarizing our DE results</h2>
<p>To generate a general summary of the DE results, we can use the
<code>summary</code> function to generate a basic summary by DESeq2.</p>
<p>However, we can also use conditional statements to determine the
number of genes that pass our thresholds for each comparison, which
might be more informative.</p>
<p><em>[Question]: How would we identify the number of genes with
adjusted p-values &lt; 0.05 and a fold-change above 1.5 (or below
-1.5)?</em></p>
<pre class="r"><code>#summary(results_plus_vs_minus)
sum(results_plus_vs_minus$padj &lt; fdr &amp; abs(results_plus_vs_minus$log2FoldChange) &gt;= log2(fc), na.rm = TRUE)</code></pre>
<pre><code>[1] 56</code></pre>
<p>How do the number of DE genes compare to what we observed from the
PCA plots?</p>
<div id="choosing-thresholds" class="section level4">
<h4>Choosing thresholds</h4>
<p>Thresholding on adjusted p-values &lt; 0.05 is a standard threshold,
but depending on the research question and/or how the results will be
used, other thresholds might be reasonable.</p>
<p>There is a nice <a href="https://www.biostars.org/p/209118/">Biostar
post that discusses choosing adjusted p-value thresholds</a>, including
cases where a more relaxed threshold might be appropriate and (some
heated) discussion of the dangers of adjusting the choosen threshold
after running an analysis. Additionally, there is a <a
href="https://bmcbioinformatics.biomedcentral.com/articles/10.1186/1471-2105-13-S2-S11">Dalmon
et al 2012</a> paper about p-value and fold-change thresholds for
microarray data that may help provide some context.</p>
</div>
<div id="subsetting-significant-genes" class="section level3">
<h3>Subsetting significant genes</h3>
<p>It can be useful to annotate our results table with additional
information to make them easier to interpret, such as adding additional
gene information or better summarizing our DE results.</p>
<details>
<summary>
<em>Click for code to generate a table of only DE genes</em>
</summary>
<p>You may be interested in identifying only the genes that pass your
significance thresholds. A useful way to do this is to conditionally
subset your results.</p>
<p><em>Note: The tidyverse functions you learned in Software Carpentry
could also be alternatively used here.</em></p>
<pre class="r"><code>res_sig = na.omit(results_plus_vs_minus)
res_sig = res_sig[which(res_sig$padj &lt; fdr &amp; abs(res_sig$log2FoldChange) &gt;= log2(fc)), ]
head(res_sig)</code></pre>
<p>For more details about sub-setting tables in R, we recommend
reviewing the <a
href="https://datacarpentry.org/R-ecology-lesson/03-dplyr.html">Data
Carpentry manipulating and analyzing data module</a>.</p>
We can also annotate our results to include a column that identifies our
significant genes.
</details>
<p>We can also add an annotation column to indicate if a gene passes the
<code>padj</code> and <code>log2FoldChange</code> thresholds we set to
call DE genes.</p>
<pre class="r"><code># add a column and assign all genes are non-significance
results_plus_vs_minus$Call = rep(FALSE, length(results_plus_vs_minus$baseMean))

# change &#39;Call&#39; column to TRUE if meets conditions for significant differences
results_plus_vs_minus[which(!is.na(results_plus_vs_minus$padj) &amp; results_plus_vs_minus$padj &lt; 0.05 &amp; abs(results_plus_vs_minus$log2FoldChange) &gt;= log2(1.5)), ]$Call = TRUE

# reorder table to rank significant genes at the top
results_plus_vs_minus = results_plus_vs_minus[order(-results_plus_vs_minus$Call),]
head(results_plus_vs_minus)</code></pre>
</div>
</div>
<div id="adding-genome-annotations" class="section level2">
<h2>Adding genome annotations</h2>
<p>Since, gene symbols can change over time or be ambiguous we use and
recommend using the EMSEMBL reference genome and ENSEMBL ids for
alignmentsand we’ve been working with tables and data where all genes
are labeled only by their long ENSEML ID. However, this can make it
difficult to quickly look at results for genes of interest.</p>
<div id="gene-symbols-versus-gene-ids" class="section level3">
<h3>Gene symbols versus Gene IDs</h3>
<p>Luckily, Bioconductor provides many tools and resources to facilitate
access to <a
href="http://bioconductor.org/packages/devel/workflows/vignettes/annotation/inst/doc/Annotation_Resources.html">genomic
annotation resources</a>.</p>
<p>To start, we will first load the <a
href="https://bioconductor.org/packages/3.14/bioc/html/biomaRt.html">biomaRt
library</a> &amp; choose what reference we want to access. For a more
detailed walk through of using biomaRt, <a
href="https://bioinformatics-core-shared-training.github.io/cruk-summer-school-2019/RNAseq/html/05_Annotation_and_Visualisation.html">this
training module</a> might be useful, including what to do when
annotations are not 1:1 mappings.</p>
<blockquote>
<h1 id="breakout-exercise-2---adding-gene-symbol-annotations"
class="unlisted unnumbered">[Breakout Exercise 2] - Adding gene symbol
annotations</h1>
<p>Navigate to <a href="">this</a> page, where we will begin our second
breakout exercise together, and then split into smaller groups to finish
it.</p>
</blockquote>
</div>
</div>
</div>
<div id="outputting-results-to-file" class="section level1">
<h1>Outputting results to file</h1>
<p>A key aspect of our analysis is preserving the relevant datasets for
both our records and for downstream applications, such as functional
enrichments.</p>
<p>First, we’ll setup a new directory for our output tables.</p>
<pre class="r"><code>dir.create(&quot;tables&quot;, showWarnings = FALSE)</code></pre>
<div id="de-results-table" class="section level2">
<h2>DE results table</h2>
<p>Next we’ll write out our DE results for the KD comparison to file,
since we added additional information to that table.</p>
<pre class="r"><code>write.csv(res_WT_anno,
          row.names = FALSE,
          na = &quot;.&quot;,
          file=&quot;tables/DEResults_ko.control_v_wt.control_annotated.csv&quot;)</code></pre>
<p>If we generated another comparision, we could repeat our annotations
or write the DE results directly to file.</p>
<pre class="r"><code>write.csv(results_plus_vs_minus,
          row.names = FALSE,
          na = &quot;.&quot;,
          file=&quot;tables/DEResults_ko.Tx_v_wt.Tx.csv&quot;)</code></pre>
</div>
<div id="count-tables" class="section level2">
<h2>Count tables</h2>
<p>The most relevant count tables are the raw, filtered count table that
we used as the input for our analysis and the rlog normalized count
table that we used for our quality control visualizations.</p>
<p>To output the raw counts, we will need to use the <code>counts</code>
function to access the count table from within its larger
<code>DESeqDataSet</code> object.</p>
<pre class="r"><code>write.csv(counts(dds, normalized = FALSE), file=&quot;tables/DESeq2_raw_counts.csv&quot;)</code></pre>
<p>Then we’ll output the rlog count table, using the <code>assay</code>
function to access the normalized count table from within its larger
<code>DESeqDataSet</code> object.</p>
<pre class="r"><code>write.csv(assay(rld), file=&quot;tables/DESeq2_rlogNormalized_counts.csv&quot;)</code></pre>
</div>
</div>
<div id="summary" class="section level1">
<h1>Summary</h1>
<p>In this section, we:</p>
<ul>
<li>Generated a volcano plot for our differential expression
results</li>
<li>Summarized our differential expression results</li>
<li>Discussed choosing thresholds</li>
<li>Annotated our tables of results to map gene IDs to gene symbols</li>
<li>Saved our results to file</li>
</ul>
</div>
<div id="key-takeaways" class="section level1">
<h1>Key takeaways</h1>
<p>Overall, we’ve run through most of the building blocks needed to run
a differential expression analysis and hopefully built up a better
understanding of how differential expression comparisons work,
particularly how experimental design can impact our results.</p>
<p>What to consider moving forward:</p>
<ul>
<li>How can I control for technical variation in my experimental
design?</li>
<li>How much variation is expected with a treatment group?</li>
<li>What is my RNA quality, and how can that be optimized?</li>
<li>Are there quality concerns for my sequencing data?</li>
<li>What comparisons are relevant to my biological question?</li>
<li>Are there covariates that should be considered?</li>
<li>What will a differential expression analysis tell me?</li>
</ul>
<p><strong>Let’s pause here for general questions</strong></p>
<hr />
</div>
<div id="what-can-we-do-with-our-de-results" class="section level1">
<h1>What can we do with our DE results?</h1>
<p>Now that we have our DE results, have we address the biological
question relevant to the authors of the <a
href="http://www.ncbi.nlm.nih.gov/pubmed/25464849">original paper</a>?
On the one hand, yes - we now have two tables of genes that are impacted
by change in Mov10 expression. But with two lists of genes alone, it can
be difficult to find patterns or understand broader biological
impacts.</p>
<p>What if we wanted to find out what genes were signifant in
<em>both</em> comparisons? The <code>intersect</code> function, such as
implimented as <a
href="https://www.datasciencemadesimple.com/intersect-function-r-using-dplyr-intersection-data-frames/">part
of the dplyr package</a> would be useful to identify shared significant
genes. A <a
href="https://www.r-graph-gallery.com/14-venn-diagramm.html">venn
diagram</a> could be a way to visualize these overlaps.</p>
<p>A way to determine possible <a
href="https://www.ebi.ac.uk/training-beta/online/courses/functional-genomics-ii-common-technologies-and-data-analysis-methods/biological-interpretation-of-gene-expression-data-2/">broader
biological interpretations</a> from the observed DE results, is
functional enrichments. There are many options, such as some included in
this <a
href="https://www.researchgate.net/post/How_can_I_analyze_a_set_of_DEGs_differentially_expressed_genes_to_obtain_information_from_them">discussion
thread</a>. Other common functional enrichments approaches are gene set
enrichment analysis, aka <a
href="http://software.broadinstitute.org/gsea/index.jsp">GSEA</a>,
Database for Annotation, Visualization and Integrated Discovery, aka <a
href="https://david.ncifcrf.gov/">DAVID</a>, <a
href="https://digitalinsights.qiagen.com/">Ingenity</a>, and [iPathway
Guide]</p>
<p>The University of Michigan has license and support for additional
tools, such as Cytoscape, so we recommend reaching out to staff with <a
href="https://www.lib.umich.edu/locations-and-hours/taubman-health-sciences-library/research-and-clinical-support">Taubman
Library</a> to learn more about resources that might be application
toyour research.</p>
<hr />
</div>
<div id="sources" class="section level1">
<h1>Sources</h1>
<ul>
<li>HBC DGE training module, part 1: <a
href="https://hbctraining.github.io/DGE_workshop/lessons/04_DGE_DESeq2_analysis.html"
class="uri">https://hbctraining.github.io/DGE_workshop/lessons/04_DGE_DESeq2_analysis.html</a></li>
<li>HBC DGE training module, part 2: <a
href="https://hbctraining.github.io/DGE_workshop/lessons/05_DGE_DESeq2_analysis2.html"
class="uri">https://hbctraining.github.io/DGE_workshop/lessons/05_DGE_DESeq2_analysis2.html</a></li>
<li>DESeq2 vignette: <a
href="http://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html#differential-expression-analysis"
class="uri">http://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html#differential-expression-analysis</a></li>
<li>Bioconductor Genomic Annotation resources: <a
href="http://bioconductor.org/packages/devel/workflows/vignettes/annotation/inst/doc/Annotation_Resources.html"
class="uri">http://bioconductor.org/packages/devel/workflows/vignettes/annotation/inst/doc/Annotation_Resources.html</a></li>
<li>BioMart vignette: <a
href="https://bioconductor.org/packages/release/bioc/vignettes/biomaRt/inst/doc/accessing_ensembl.html"
class="uri">https://bioconductor.org/packages/release/bioc/vignettes/biomaRt/inst/doc/accessing_ensembl.html</a></li>
</ul>
</div>
<div id="additional-resources" class="section level1">
<h1>Additional Resources</h1>
<ul>
<li>MIDAS Reproduciblity Hub: <a
href="https://midas.umich.edu/reproducibility-overview/"
class="uri">https://midas.umich.edu/reproducibility-overview/</a></li>
<li>ARC resources: <a href="https://arc-ts.umich.edu/"
class="uri">https://arc-ts.umich.edu/</a></li>
<li>Gene Set Enrichment Resources from Bioconductor: <a
href="https://bioinformatics-core-shared-training.github.io/cruk-summer-school-2018/RNASeq2018/html/06_Gene_set_testing.nb.html"
class="uri">https://bioinformatics-core-shared-training.github.io/cruk-summer-school-2018/RNASeq2018/html/06_Gene_set_testing.nb.html</a></li>
<li>Using HTSeq data with DESeq2: <a
href="https://angus.readthedocs.io/en/2019/diff-ex-and-viz.html"
class="uri">https://angus.readthedocs.io/en/2019/diff-ex-and-viz.html</a></li>
<li>Detailed RNA-seq analysis paper: <a
href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6096346/"
class="uri">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6096346/</a></li>
<li>Overview of RNA-seq analysis considerations: <a
href="https://academic-oup-com.proxy.lib.umich.edu/bfg/article/14/2/130/257370"
class="uri">https://academic-oup-com.proxy.lib.umich.edu/bfg/article/14/2/130/257370</a></li>
<li>Alternative overview of DESeq2, including visualizations and
functional enrichments: <a
href="http://dputhier.github.io/jgb71e-polytech-bioinfo-app/practical/rna-seq_R/rnaseq_diff_Snf2.html"
class="uri">http://dputhier.github.io/jgb71e-polytech-bioinfo-app/practical/rna-seq_R/rnaseq_diff_Snf2.html</a></li>
</ul>
<hr />
</div>
<div id="session-info" class="section level1">
<h1>Session Info</h1>
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.1 (2022-06-23)
Platform: x86_64-apple-darwin17.0 (64-bit)
Running under: macOS Monterey 12.5

Matrix products: default
LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats4    stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] biomaRt_2.52.0              data.table_1.14.2           RColorBrewer_1.1-3          pheatmap_1.0.12            
 [5] ggrepel_0.9.1               dplyr_1.0.9                 tidyr_1.2.0                 ggplot2_3.3.6              
 [9] DESeq2_1.36.0               SummarizedExperiment_1.26.1 Biobase_2.56.0              MatrixGenerics_1.8.1       
[13] matrixStats_0.62.0          GenomicRanges_1.48.0        GenomeInfoDb_1.32.2         IRanges_2.30.0             
[17] S4Vectors_0.34.0            BiocGenerics_0.42.0         knitr_1.39                  rmarkdown_2.14             

loaded via a namespace (and not attached):
 [1] bitops_1.0-7           bit64_4.0.5            filelock_1.0.2         progress_1.2.2         httr_1.4.3            
 [6] tools_4.2.1            bslib_0.4.0            utf8_1.2.2             R6_2.5.1               DBI_1.1.3             
[11] colorspace_2.0-3       withr_2.5.0            prettyunits_1.1.1      tidyselect_1.1.2       curl_4.3.2            
[16] bit_4.0.4              compiler_4.2.1         cli_3.3.0              xml2_1.3.3             DelayedArray_0.22.0   
[21] labeling_0.4.2         sass_0.4.2             scales_1.2.0           genefilter_1.78.0      rappdirs_0.3.3        
[26] stringr_1.4.0          digest_0.6.29          XVector_0.36.0         pkgconfig_2.0.3        htmltools_0.5.3       
[31] dbplyr_2.2.1           highr_0.9              fastmap_1.1.0          rlang_1.0.4            rstudioapi_0.13       
[36] RSQLite_2.2.15         farver_2.1.1           jquerylib_0.1.4        generics_0.1.3         jsonlite_1.8.0        
[41] BiocParallel_1.30.3    RCurl_1.98-1.8         magrittr_2.0.3         GenomeInfoDbData_1.2.8 Matrix_1.4-1          
[46] Rcpp_1.0.9             munsell_0.5.0          fansi_1.0.3            lifecycle_1.0.1        stringi_1.7.8         
[51] yaml_2.3.5             zlibbioc_1.42.0        BiocFileCache_2.4.0    grid_4.2.1             blob_1.2.3            
[56] parallel_4.2.1         crayon_1.5.1           lattice_0.20-45        Biostrings_2.64.0      splines_4.2.1         
[61] annotate_1.74.0        hms_1.1.1              KEGGREST_1.36.3        locfit_1.5-9.6         pillar_1.8.0          
[66] geneplotter_1.74.0     codetools_0.2-18       XML_3.99-0.10          glue_1.6.2             evaluate_0.15         
[71] BiocManager_1.30.18    png_0.1-7              vctrs_0.4.1            gtable_0.3.0           purrr_0.3.4           
[76] assertthat_0.2.1       cachem_1.0.6           xfun_0.31              xtable_1.8-4           survival_3.3-1        
[81] tibble_3.1.7           AnnotationDbi_1.58.0   memoise_2.0.1          ellipsis_0.3.2        </code></pre>
<hr />
<p>These materials have been adapted and extended from materials listed
above. These are open access materials distributed under the terms of
the <a href="http://creativecommons.org/licenses/by/4.0/">Creative
Commons Attribution license (CC BY 4.0)</a>, which permits unrestricted
use, distribution, and reproduction in any medium, provided the original
author and source are credited.</p>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiTW9kdWxlIDExOiBERSBWaXN1YWxpemF0aW9ucyBhbmQgQW5ub3RhdGlvbiIKYXV0aG9yOiAiVU0gQmlvaW5mb3JtYXRpY3MgQ29yZSIKZGF0ZTogImByIFN5cy5EYXRlKClgIgpvdXRwdXQ6CiAgICAgICAgaHRtbF9kb2N1bWVudDoKICAgICAgICAgICAgaW5jbHVkZXM6CiAgICAgICAgICAgICAgICBpbl9oZWFkZXI6IGhlYWRlci5odG1sCiAgICAgICAgICAgIHRoZW1lOiBwYXBlcgogICAgICAgICAgICB0b2M6IHRydWUKICAgICAgICAgICAgdG9jX2RlcHRoOiA0CiAgICAgICAgICAgIHRvY19mbG9hdDogdHJ1ZQogICAgICAgICAgICBudW1iZXJfc2VjdGlvbnM6IGZhbHNlCiAgICAgICAgICAgIGZpZ19jYXB0aW9uOiB0cnVlCiAgICAgICAgICAgIG1hcmtkb3duOiBHRk0KICAgICAgICAgICAgY29kZV9kb3dubG9hZDogdHJ1ZQotLS0KCjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+CmJvZHksIHRkIHsKICAgZm9udC1zaXplOiAxOHB4Owp9CmNvZGUucnsKICBmb250LXNpemU6IDEycHg7Cn0KcHJlIHsKICBmb250LXNpemU6IDEycHgKfQo8L3N0eWxlPgoKYGBge3IsIGluY2x1ZGUgPSBGQUxTRX0Kc291cmNlKCIuLi9iaW4vY2h1bmstb3B0aW9ucy5SIikKa25pdHJfZmlnX3BhdGgoIjExLSIpCmBgYAoKPiAjIE9iamVjdGl2ZXMgey51bmxpc3RlZCAudW5udW1iZXJlZH0KPiAqIFVuZGVyc3RhbmQgYWR2YW50YWdlcyBvZiB1c2luZyBnZW5lIGlkcyB3aGVuIGFuYWx5emluZyBkYXRhLgo+ICogR2l2ZW4gYSBsaXN0IG9mIEVOU0VNQkwgZ2VuZSBpZHMsIGFkZCBnZW5lIHN5bWJvbHMgYW5kIEVudHJleiBhY2Nlc3Npb25zLgo+ICogR2VuZXJhdGUgY29tbW9uIHZpc3VhbGl6YXRpb25zIGZvciBkaWZmZXJlbnRpYWwgZXhwcmVzc2lvbiBjb21wYXJpc29ucwo+ICogVW5kZXJzdGFuZCBjaG9vc2luZyB0aHJlc2hvbGRzIGZvciBjYWxsaW5nIGRpZmZlcmVudGlhbGx5IGV4cHJlc3NlZCBnZW5lcwo+ICogRGlzY3VzcyBvcHRpb25zIGZvciBmdW5jdGlvbmFsIGVucmljaG1lbnRzCgpgYGB7ciBNb2R1bGVzLCBldmFsPVRSVUUsIGVjaG89RkFMU0UsIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0V9CmxpYnJhcnkoREVTZXEyKQpsaWJyYXJ5KGdncGxvdDIpCmxpYnJhcnkodGlkeXIpCmxpYnJhcnkoZHBseXIpCmxpYnJhcnkoZ2dyZXBlbCkKbGlicmFyeShSQ29sb3JCcmV3ZXIpCmxvYWQoInJkYXRhL1J1bm5pbmdEYXRhLlJEYXRhIikKYGBgCgojIERpZmZlcmVudGlhbCBFeHByZXNzaW9uIFdvcmtmbG93CgpIZXJlIHdlIHdpbGwgZ2VuZXJhdGUgc3VtbWFyeSBmaWd1cmVzIGZvciBvdXIgcmVzdWx0cyBhbmQgYW5ub3RhdGUgb3VyIERFIHRhYmxlcy4KCiFbXSguL2ltYWdlcy93YXlmaW5kZXIvd2F5ZmluZGVyLTExLnBuZyl7d2lkdGg9NzUlfQoKKipUT0RPOiBkb3VibGUgY2hlY2sgcmVmZXJlbmNlcyB0byBhbm5vdGF0ZWQgdGFibGUgcHJpb3IgdG8gcnVubmluZyBhbm5vdGF0aW9ucyoqCgotLS0KCiMgVmlzdWFsaXppbmcgREUgcmVzdWx0cwoKUGFydCBvZiBkaWZmZXJlbnRpYWwgZXhwcmVzc2lvbiBhbmFseXNpcyBpcyBnZW5lcmF0aW5nIHZpc3VhbGl6YXRpb25zIHRvIHNoYXJlIG91ciByZXN1bHRzLiBXaGlsZSB0aGUgREVTZXEyIHR1dG9yaWFsIHByb3ZpZGVzIFtleGFtcGxlcyBvZiBvdGhlciB2aXN1YWxpemF0aW9uc10oaHR0cDovL2Jpb2NvbmR1Y3Rvci5vcmcvcGFja2FnZXMvZGV2ZWwvYmlvYy92aWduZXR0ZXMvREVTZXEyL2luc3QvZG9jL0RFU2VxMi5odG1sI2V4cGxvcmluZy1hbmQtZXhwb3J0aW5nLXJlc3VsdHMpLCBhIGNvbW1vbiB2aXN1YWxpemF0aW9uIHRvIHN1bW1hcml6ZSBERSBjb21wYXJpc29ucyBhcmUgW3ZvbGNhbm8gcGxvdHNdKGh0dHA6Ly9yZXNvdXJjZXMucWlhZ2VuYmlvaW5mb3JtYXRpY3MuY29tL21hbnVhbHMvY2xjZ2Vub21pY3N3b3JrYmVuY2gvNzUyL2luZGV4LnBocD9tYW51YWw9Vm9sY2Fub19wbG90c19pbnNwZWN0aW5nX3Jlc3VsdF9zdGF0aXN0aWNhbF9hbmFseXNpcy5odG1sKS4KCiMjIEdlbmVyYXRpbmcgVm9sY2FubyBwbG90cwoKQXMgZGVzY3JpYmVkIGJ5IHRoaXMgW0dhbGF4eSBwcm9qZWN0IHR1dG9yaWFsXShodHRwczovL2dhbGF4eXByb2plY3QuZ2l0aHViLmlvL3RyYWluaW5nLW1hdGVyaWFsL3RvcGljcy90cmFuc2NyaXB0b21pY3MvdHV0b3JpYWxzL3JuYS1zZXEtdml6LXdpdGgtdm9sY2Fub3Bsb3QvdHV0b3JpYWwuaHRtbCksIGEgdm9sY2FubyBwbG90IGlzIGEgdHlwZSBvZiBzY2F0dGVycGxvdCB0aGF0IHNob3dzIHN0YXRpc3RpY2FsIHNpZ25pZmljYW5jZSAoYWRqdXN0ZWQgcC12YWx1ZSkgdmVyc3VzIG1hZ25pdHVkZSBvZiBjaGFuZ2UgKGZvbGQgY2hhbmdlKS4gSW4gYSB2b2xjYW5vIHBsb3QsIHRoZSBtb3N0IHVwcmVndWxhdGVkIGdlbmVzIGFyZSB0b3dhcmRzIHRoZSByaWdodCwgdGhlIG1vc3QgZG93bnJlZ3VsYXRlZCBnZW5lcyBhcmUgdG93YXJkcyB0aGUgbGVmdCwgYW5kIHRoZSBtb3N0IHN0YXRpc3RpY2FsbHkgc2lnbmlmaWNhbnQgZ2VuZXMgYXJlIHRvd2FyZHMgdGhlIHRvcC4KCkZpcnN0LCB3ZSBuZWVkIHRvIHNldCB0aHJlc2hvbGRzIGZvciBkZXRlcm1pbmluZyBzaWduaWZpY2FudCBnZW5lcy4gQSByZWFzb25hYmxlIHRocmVzaG9sZCB3b3VsZCBiZSBhIGZvbGQtY2hhbmdlIG9mIGxlc3MgdGhhbiAtMS41IG9yIGdyZWF0ZXIgdGhhbiAxLjUgYW5kIGFuIGFkanVzdGVkIHB2YWx1ZSBsZXNzIHRoYW4gMC4wNS4KCmBgYHtyIFBsb3RTZXR1cDF9CmZjID0gMS41CmZkciA9IDAuMDUKYGBgCgpOZXh0LCB3ZSdsbCBzZXQgdXAgYW4gb2JqZWN0IG9uIHdoaWNoIHdlJ2xsIHVzZSBhcyB0aGUgYmFzaXMgZm9yIG91ciBwbG90LiBMZXQncyBjb2VyY2UgdGhlIGBEYXRhRnJhbWVgIHdoaWNoIHdhcyByZXR1cm5lZCBpbnRvIGEgYHRpYmJsZWAgYW5kIHVzZSBzb21lIGB0aWR5dmVyc2VgIGZ1bmN0aW9ucyB0byBkbyB0aGlzOgoKYGBge3IgUGxvdFNldHVwMn0KIyBMZXQncyBmaXJzdCBzd2luZyB0aGUgcm93bmFtZXMgb3V0IGFzIGEgY29sdW1uIGFuZCBjb2VyY2UgdG8gYSB0aWJibGUKcmVzdWx0c19wbHVzX3ZzX21pbnVzID0gYXNfdGliYmxlKHJlc3VsdHNfcGx1c192c19taW51cywgcm93bmFtZXMgPSAnaWQnKSAlPiUgYXJyYW5nZShwYWRqKQoKIyBOb3cgbGV0J3Mgc2F2ZSBhIGNvcHkgdG8gYWRkIGNvbHVtbnMgZm9yIG91ciBwbG90cwpkZiA9IHJlc3VsdHNfcGx1c192c19taW51cwoKY29tcGFyaXNvbiA9ICdwbHVzX3ZzX21pbnVzJwpgYGAKCk9uY2Ugd2UndmUgc2V0dXAgdGhlIGFubm90YXRpb25zIHdlIG5lZWQsIHdlIGNhbiBwcm9jZWVkIHdpdGggZ2VuZXJhdGluZyB0aGUgdm9sY2FubyBwbG90LCBpbmNsdWRpbmcgb3VyIHRocmVzaG9sZHMuCgpgYGB7ciBWb2xjYW5vUGxvdCwgbWVzc2FnZT1GQUxTRSwgd2FybmluZz1GQUxTRX0KIyBJbml0aWFsaXplIHRoZSBwbG90LCBzYXZpbmcgYXMgb2JqZWN0ICdwJyBhbmQgc3BlY2lmeWluZyB0aGUgcGxvdCB0eXBlIGFzICdnZW9tX3BvaW50JwpwID0gZ2dwbG90KGRmLCBhZXMoeCA9IGxvZzJGb2xkQ2hhbmdlLCB5ID0gLWxvZzEwKHBhZGopKSkgKwogICAgZ2VvbV9wb2ludChzaGFwZSA9IDIxLCBjb2xvdXI9ICdkYXJrZ3JleScsIHNpemUgPSAxKSArCiAgICB0aGVtZV9idygpICsKICAgIHhsYWIoJ0xvZzIgZm9sZC1jaGFuZ2UnKSArIHlsYWIoJy1Mb2cxMCBhZGp1c3RlZCBwLXZhbHVlJykKCiMgQWRkIHRocmVzaG9sZCBsaW5lcwpwID0gcCArCiAgICBnZW9tX3ZsaW5lKAogICAgICAgIHhpbnRlcmNlcHQgPSBjKDAsIC1sb2cyKGZjKSwgbG9nMihmYykpLAogICAgICAgIGxpbmV0eXBlID0gYygxLCAyLCAyKSkgKwogICAgZ2VvbV9obGluZSgKICAgICAgICB5aW50ZXJjZXB0ID0gLWxvZzEwKGZkciksCiAgICAgICAgbGluZXR5cGUgPSAyKQoKIyBBZGQgVGl0bGUgdGhhdCBpbmNsdWRlcyBjb21wYXJpc29uIG5hbWUKcCA9IHAgKyBnZ3RpdGxlKGFzLmNoYXJhY3Rlcihjb21wYXJpc29uKSkKCiMgRGlzcGxheSB0aGUgcGxvdCBpbiB0aGUgcGxvdHMgcGFuZSBvZiBSU3R1ZGlvCnAKYGBgCgo8ZGV0YWlscz4KPHN1bW1hcnk+KkNsaWNrIGZvciBjb2xvciBjb2RlZCB2b2xjYW5vIHBsb3QqPC9zdW1tYXJ5PgpOb3cgd2UgbmVlZCB0byBbc3Vic2V0IG91ciBkYXRhXShodHRwczovL3d3dy5zdGF0bWV0aG9kcy5uZXQvbWFuYWdlbWVudC9zdWJzZXQuaHRtbCkgdG8gbGFiZWwgdGhlIGRhdGFwb2ludHMgKGdlbmVzKSB0aGF0IHBhc3Mgb3VyIHRocmVzaG9sZHMuCgpgYGB7ciBQbG90U2V0dXAyYSwgbWVzc2FnZT1GQUxTRSwgd2FybmluZz1GQUxTRX0KZGYkZG90ID0gcmVwKDMsIG5yb3coZGYpKQpkZiRkb3Rbd2hpY2goZGYkcGFkaiA8PSBmZHIgJiBkZiRsb2cyRm9sZENoYW5nZSA8IDAgJiBhYnMoZGYkbG9nMkZvbGRDaGFuZ2UpID49IGxvZzIoZmMpKV0gPSAyCmRmJGRvdFt3aGljaChkZiRwYWRqIDw9IGZkciAmIGRmJGxvZzJGb2xkQ2hhbmdlID4gMCAmIGFicyhkZiRsb2cyRm9sZENoYW5nZSkgPj0gbG9nMihmYykpXSA9IDEKZGYkc2lnID0gZGYkZG90CgojdGFrZSB0b3AgNSB1cCwgZG93biwgdGhlbiBjb21iaW5lLCBhc3NpZ24gbGFiZWwKdG9wID0gcmJpbmQoaGVhZChzdWJzZXQoZGYsIGRmJGRvdCA9PSAxKSwgNSksaGVhZChzdWJzZXQoZGYsIGRmJGRvdCA9PSAyKSwgNSkpCnRvcCRsYWJlbCA9IHRvcCRpZApkZiA9IG1lcmdlKHggPSBkZiwgeSA9IHRvcFssYygnaWQnLCdsYWJlbCcpXSwgYnkgPSAiaWQiLCBhbGwueCA9IFRSVUUpCgojY291bnQgdGhlIG51bWJlciBvZiBzaWduaWZpY2FuIHVwIGFuZCBkb3duIGdlbmVzLCBhc3NpZ24gdmFsdWUgZm9yIGxlZ2VuZApkZiRkb3QgPSBmYWN0b3IoZGYkZG90LGxldmVscyA9IGMoMSwyLDMpLCBsYWJlbHMgPSBjKHBhc3RlMCgnVXA6ICcsIHN1bShkZiRkb3QgPT0gMSkpLHBhc3RlMCgnRG93bjogJywgc3VtKGRmJGRvdCA9PSAyKSksJ05TJykpCmBgYAoKT25jZSB3ZSd2ZSBzZXR1cCB0aGUgYW5ub3RhdGlvbnMgd2UgbmVlZCwgd2UgY2FuIHByb2NlZWQgd2l0aCBnZW5lcmF0aW5nIHRoZSB2b2xjYW5vIHBsb3QuCgpgYGB7ciBWb2xjYW5vUGxvdDIsIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0V9CnAgPSBnZ3Bsb3QoZGYsIGFlcyh4ID0gbG9nMkZvbGRDaGFuZ2UsIHkgPSAtbG9nMTAocGFkaikpKSArCiAgICBnZW9tX3BvaW50KGFlcyhjb2xvciA9IGRmJGRvdCksIHNpemUgPSAxKSArCiAgICB0aGVtZV9jbGFzc2ljKCkgKwogICAgeGxhYignTG9nMiBmb2xkLWNoYW5nZScpICsgeWxhYignLUxvZzEwIGFkanVzdGVkIHAtdmFsdWUnKQojIHNwZWNpZnkgY29sb3JzIGZvciB1cC0vZG93bi0vbm9uc2lnbmlmaWNhbnQgZ2VuZXMKcCA9IHAgKyBzY2FsZV9jb2xvcl9tYW51YWwobmFtZSA9ICcnLCB2YWx1ZXM9YygnI0IzMUIyMScsICcjMTQ2NUFDJywgJ2RhcmtncmF5JykpCiMgYWRkIHRocmVzaG9sIGxpbmVzCnAgPSBwICsKICAgIGdlb21fdmxpbmUoCiAgICAgICAgeGludGVyY2VwdCA9IGMoMCwgLWxvZzIoZmMpLCBsb2cyKGZjKSksCiAgICAgICAgbGluZXR5cGUgPSBjKDEsIDIsIDIpLAogICAgICAgIGNvbG9yID0gYygnYmxhY2snLCAnYmxhY2snLCAnYmxhY2snKSkgKwogICAgZ2VvbV9obGluZSgKICAgICAgICB5aW50ZXJjZXB0ID0gLWxvZzEwKGZkciksCiAgICAgICAgbGluZXR5cGUgPSAyLAogICAgICAgIGNvbG9yID0gJ2JsYWNrJykKIyBBZGQgVGl0bGUgdGhhdCBpbmNsdWRlcyBjb21wYXJpc29uIG5hbWUKcCA9IHAgKyBnZ3RpdGxlKGFzLmNoYXJhY3Rlcihjb21wYXJpc29uKSkKCnAKYGBgCjwvZGV0YWlscz4KPGJyPgoKRm9yIGFkZGl0aW9uYWwgdmlzdWFsaXphdGlvbnMgZm9yIG91ciBERSByZXN1bHRzLCB3ZSBpbmNsdWRlZCBzb21lIGV4YW1wbGUgY29kZSBpbiB0aGUgQm9udXMgQ29udGVudCBtb2R1bGUgYW5kIHRoaXMgW0hCQyB0dXRvcmlhbF0oaHR0cHM6Ly9oYmN0cmFpbmluZy5naXRodWIuaW8vREdFX3dvcmtzaG9wL2xlc3NvbnMvMDZfREdFX3Zpc3VhbGl6aW5nX3Jlc3VsdHMuaHRtbCkgaW5jbHVkZXMgc29tZSBuaWNlIGV4YW1wbGVzLgoKIyMgU3VtbWFyaXppbmcgb3VyIERFIHJlc3VsdHMKClRvIGdlbmVyYXRlIGEgZ2VuZXJhbCBzdW1tYXJ5IG9mIHRoZSBERSByZXN1bHRzLCB3ZSBjYW4gdXNlIHRoZSBgc3VtbWFyeWAgZnVuY3Rpb24gdG8gZ2VuZXJhdGUgYSBiYXNpYyBzdW1tYXJ5IGJ5IERFU2VxMi4KCkhvd2V2ZXIsIHdlIGNhbiBhbHNvIHVzZSBjb25kaXRpb25hbCBzdGF0ZW1lbnRzIHRvIGRldGVybWluZSB0aGUgbnVtYmVyIG9mIGdlbmVzIHRoYXQgcGFzcyBvdXIgdGhyZXNob2xkcyBmb3IgZWFjaCBjb21wYXJpc29uLCB3aGljaCBtaWdodCBiZSBtb3JlIGluZm9ybWF0aXZlLgoKKltRdWVzdGlvbl06IEhvdyB3b3VsZCB3ZSBpZGVudGlmeSB0aGUgbnVtYmVyIG9mIGdlbmVzIHdpdGggYWRqdXN0ZWQgcC12YWx1ZXMgPCAwLjA1IGFuZCBhIGZvbGQtY2hhbmdlIGFib3ZlIDEuNSAob3IgYmVsb3cgLTEuNSk/KgoKYGBge3IgU3RhdFNpZ0dlbmVzMn0KI3N1bW1hcnkocmVzdWx0c19wbHVzX3ZzX21pbnVzKQpzdW0ocmVzdWx0c19wbHVzX3ZzX21pbnVzJHBhZGogPCBmZHIgJiBhYnMocmVzdWx0c19wbHVzX3ZzX21pbnVzJGxvZzJGb2xkQ2hhbmdlKSA+PSBsb2cyKGZjKSwgbmEucm0gPSBUUlVFKQpgYGAKCkhvdyBkbyB0aGUgbnVtYmVyIG9mIERFIGdlbmVzIGNvbXBhcmUgdG8gd2hhdCB3ZSBvYnNlcnZlZCBmcm9tIHRoZSBQQ0EgcGxvdHM/CgojIyMjIENob29zaW5nIHRocmVzaG9sZHMKClRocmVzaG9sZGluZyBvbiBhZGp1c3RlZCBwLXZhbHVlcyA8IDAuMDUgaXMgYSBzdGFuZGFyZCB0aHJlc2hvbGQsIGJ1dCBkZXBlbmRpbmcgb24gdGhlIHJlc2VhcmNoIHF1ZXN0aW9uIGFuZC9vciBob3cgdGhlIHJlc3VsdHMgd2lsbCBiZSB1c2VkLCBvdGhlciB0aHJlc2hvbGRzIG1pZ2h0IGJlIHJlYXNvbmFibGUuCgpUaGVyZSBpcyBhIG5pY2UgW0Jpb3N0YXIgcG9zdCB0aGF0IGRpc2N1c3NlcyBjaG9vc2luZyBhZGp1c3RlZCBwLXZhbHVlIHRocmVzaG9sZHNdKGh0dHBzOi8vd3d3LmJpb3N0YXJzLm9yZy9wLzIwOTExOC8pLCBpbmNsdWRpbmcgY2FzZXMgd2hlcmUgYSBtb3JlIHJlbGF4ZWQgdGhyZXNob2xkIG1pZ2h0IGJlIGFwcHJvcHJpYXRlIGFuZCAoc29tZSBoZWF0ZWQpIGRpc2N1c3Npb24gb2YgdGhlIGRhbmdlcnMgb2YgYWRqdXN0aW5nIHRoZSBjaG9vc2VuIHRocmVzaG9sZCBhZnRlciBydW5uaW5nIGFuIGFuYWx5c2lzLiBBZGRpdGlvbmFsbHksIHRoZXJlIGlzIGEgW0RhbG1vbiBldCBhbCAyMDEyXShodHRwczovL2JtY2Jpb2luZm9ybWF0aWNzLmJpb21lZGNlbnRyYWwuY29tL2FydGljbGVzLzEwLjExODYvMTQ3MS0yMTA1LTEzLVMyLVMxMSkgcGFwZXIgYWJvdXQgcC12YWx1ZSBhbmQgZm9sZC1jaGFuZ2UgdGhyZXNob2xkcyBmb3IgbWljcm9hcnJheSBkYXRhIHRoYXQgbWF5IGhlbHAgcHJvdmlkZSBzb21lIGNvbnRleHQuCgojIyMgU3Vic2V0dGluZyBzaWduaWZpY2FudCBnZW5lcwoKSXQgY2FuIGJlIHVzZWZ1bCB0byBhbm5vdGF0ZSBvdXIgcmVzdWx0cyB0YWJsZSB3aXRoIGFkZGl0aW9uYWwgaW5mb3JtYXRpb24gdG8gbWFrZSB0aGVtIGVhc2llciB0byBpbnRlcnByZXQsIHN1Y2ggYXMgYWRkaW5nIGFkZGl0aW9uYWwgZ2VuZSBpbmZvcm1hdGlvbiBvciBiZXR0ZXIgc3VtbWFyaXppbmcgb3VyIERFIHJlc3VsdHMuCgo8ZGV0YWlscz4KPHN1bW1hcnk+KkNsaWNrIGZvciBjb2RlIHRvIGdlbmVyYXRlIGEgdGFibGUgb2Ygb25seSBERSBnZW5lcyo8L3N1bW1hcnk+CllvdSBtYXkgYmUgaW50ZXJlc3RlZCBpbiBpZGVudGlmeWluZyBvbmx5IHRoZSBnZW5lcyB0aGF0IHBhc3MgeW91ciBzaWduaWZpY2FuY2UgdGhyZXNob2xkcy4gQSB1c2VmdWwgd2F5IHRvIGRvIHRoaXMgaXMgdG8gY29uZGl0aW9uYWxseSBzdWJzZXQgeW91ciByZXN1bHRzLgoKKk5vdGU6IFRoZSB0aWR5dmVyc2UgZnVuY3Rpb25zIHlvdSBsZWFybmVkIGluIFNvZnR3YXJlIENhcnBlbnRyeSBjb3VsZCBhbHNvIGJlIGFsdGVybmF0aXZlbHkgdXNlZCBoZXJlLioKCmBgYHtyIENvbmRpdGlvbmFsU3Vic2V0LCBldmFsPUZBTFNFfQpyZXNfc2lnID0gbmEub21pdChyZXN1bHRzX3BsdXNfdnNfbWludXMpCnJlc19zaWcgPSByZXNfc2lnW3doaWNoKHJlc19zaWckcGFkaiA8IGZkciAmIGFicyhyZXNfc2lnJGxvZzJGb2xkQ2hhbmdlKSA+PSBsb2cyKGZjKSksIF0KaGVhZChyZXNfc2lnKQpgYGAKCkZvciBtb3JlIGRldGFpbHMgYWJvdXQgc3ViLXNldHRpbmcgdGFibGVzIGluIFIsIHdlIHJlY29tbWVuZCByZXZpZXdpbmcgdGhlIFtEYXRhIENhcnBlbnRyeSBtYW5pcHVsYXRpbmcgYW5kIGFuYWx5emluZyBkYXRhIG1vZHVsZV0oaHR0cHM6Ly9kYXRhY2FycGVudHJ5Lm9yZy9SLWVjb2xvZ3ktbGVzc29uLzAzLWRwbHlyLmh0bWwpLgoKV2UgY2FuIGFsc28gYW5ub3RhdGUgb3VyIHJlc3VsdHMgdG8gaW5jbHVkZSBhIGNvbHVtbiB0aGF0IGlkZW50aWZpZXMgb3VyIHNpZ25pZmljYW50IGdlbmVzLgo8L2RldGFpbHM+CgpXZSBjYW4gYWxzbyBhZGQgYW4gYW5ub3RhdGlvbiBjb2x1bW4gdG8gaW5kaWNhdGUgaWYgYSBnZW5lIHBhc3NlcyB0aGUgYHBhZGpgIGFuZCBgbG9nMkZvbGRDaGFuZ2VgIHRocmVzaG9sZHMgd2Ugc2V0IHRvIGNhbGwgREUgZ2VuZXMuCmBgYHtyIENvbmRpdGlvbmFsQW5ubywgZXZhbD1GQUxTRX0KIyBhZGQgYSBjb2x1bW4gYW5kIGFzc2lnbiBhbGwgZ2VuZXMgYXJlIG5vbi1zaWduaWZpY2FuY2UKcmVzdWx0c19wbHVzX3ZzX21pbnVzJENhbGwgPSByZXAoRkFMU0UsIGxlbmd0aChyZXN1bHRzX3BsdXNfdnNfbWludXMkYmFzZU1lYW4pKQoKIyBjaGFuZ2UgJ0NhbGwnIGNvbHVtbiB0byBUUlVFIGlmIG1lZXRzIGNvbmRpdGlvbnMgZm9yIHNpZ25pZmljYW50IGRpZmZlcmVuY2VzCnJlc3VsdHNfcGx1c192c19taW51c1t3aGljaCghaXMubmEocmVzdWx0c19wbHVzX3ZzX21pbnVzJHBhZGopICYgcmVzdWx0c19wbHVzX3ZzX21pbnVzJHBhZGogPCAwLjA1ICYgYWJzKHJlc3VsdHNfcGx1c192c19taW51cyRsb2cyRm9sZENoYW5nZSkgPj0gbG9nMigxLjUpKSwgXSRDYWxsID0gVFJVRQoKIyByZW9yZGVyIHRhYmxlIHRvIHJhbmsgc2lnbmlmaWNhbnQgZ2VuZXMgYXQgdGhlIHRvcApyZXN1bHRzX3BsdXNfdnNfbWludXMgPSByZXN1bHRzX3BsdXNfdnNfbWludXNbb3JkZXIoLXJlc3VsdHNfcGx1c192c19taW51cyRDYWxsKSxdCmhlYWQocmVzdWx0c19wbHVzX3ZzX21pbnVzKQpgYGAKCiMjIEFkZGluZyBnZW5vbWUgYW5ub3RhdGlvbnMKClNpbmNlLCBnZW5lIHN5bWJvbHMgY2FuIGNoYW5nZSBvdmVyIHRpbWUgb3IgYmUgYW1iaWd1b3VzIHdlIHVzZSBhbmQgcmVjb21tZW5kIHVzaW5nIHRoZSBFTVNFTUJMIHJlZmVyZW5jZSBnZW5vbWUgYW5kIEVOU0VNQkwgaWRzIGZvciBhbGlnbm1lbnRzYW5kIHdlJ3ZlIGJlZW4gd29ya2luZyB3aXRoIHRhYmxlcyBhbmQgZGF0YSB3aGVyZSBhbGwgZ2VuZXMgYXJlIGxhYmVsZWQgb25seSBieSB0aGVpciBsb25nIEVOU0VNTCBJRC4gSG93ZXZlciwgdGhpcyBjYW4gbWFrZSBpdCBkaWZmaWN1bHQgdG8gcXVpY2tseSBsb29rIGF0IHJlc3VsdHMgZm9yIGdlbmVzIG9mIGludGVyZXN0LgoKIyMjIEdlbmUgc3ltYm9scyB2ZXJzdXMgR2VuZSBJRHMKCkx1Y2tpbHksIEJpb2NvbmR1Y3RvciBwcm92aWRlcyBtYW55IHRvb2xzIGFuZCByZXNvdXJjZXMgdG8gZmFjaWxpdGF0ZSBhY2Nlc3MgdG8gW2dlbm9taWMgYW5ub3RhdGlvbiByZXNvdXJjZXNdKGh0dHA6Ly9iaW9jb25kdWN0b3Iub3JnL3BhY2thZ2VzL2RldmVsL3dvcmtmbG93cy92aWduZXR0ZXMvYW5ub3RhdGlvbi9pbnN0L2RvYy9Bbm5vdGF0aW9uX1Jlc291cmNlcy5odG1sKS4KClRvIHN0YXJ0LCB3ZSB3aWxsIGZpcnN0IGxvYWQgdGhlIFtiaW9tYVJ0IGxpYnJhcnldKGh0dHBzOi8vYmlvY29uZHVjdG9yLm9yZy9wYWNrYWdlcy8zLjE0L2Jpb2MvaHRtbC9iaW9tYVJ0Lmh0bWwpICYgY2hvb3NlIHdoYXQgcmVmZXJlbmNlIHdlIHdhbnQgdG8gYWNjZXNzLiBGb3IgYSBtb3JlIGRldGFpbGVkIHdhbGsgdGhyb3VnaCBvZiB1c2luZyBiaW9tYVJ0LCBbdGhpcyB0cmFpbmluZyBtb2R1bGVdKGh0dHBzOi8vYmlvaW5mb3JtYXRpY3MtY29yZS1zaGFyZWQtdHJhaW5pbmcuZ2l0aHViLmlvL2NydWstc3VtbWVyLXNjaG9vbC0yMDE5L1JOQXNlcS9odG1sLzA1X0Fubm90YXRpb25fYW5kX1Zpc3VhbGlzYXRpb24uaHRtbCkgbWlnaHQgYmUgdXNlZnVsLCBpbmNsdWRpbmcgd2hhdCB0byBkbyB3aGVuIGFubm90YXRpb25zIGFyZSBub3QgMToxIG1hcHBpbmdzLgoKPiAjIFtCcmVha291dCBFeGVyY2lzZSAyXSAtIEFkZGluZyBnZW5lIHN5bWJvbCBhbm5vdGF0aW9ucyB7LnVubGlzdGVkIC51bm51bWJlcmVkfQo+Cj4gTmF2aWdhdGUgdG8gW3RoaXNdKCkgcGFnZSwgd2hlcmUgd2Ugd2lsbCBiZWdpbiBvdXIgc2Vjb25kIGJyZWFrb3V0IGV4ZXJjaXNlIHRvZ2V0aGVyLCBhbmQgdGhlbiBzcGxpdCBpbnRvIHNtYWxsZXIgZ3JvdXBzIHRvIGZpbmlzaCBpdC4KCiMgT3V0cHV0dGluZyByZXN1bHRzIHRvIGZpbGUKCkEga2V5IGFzcGVjdCBvZiBvdXIgYW5hbHlzaXMgaXMgcHJlc2VydmluZyB0aGUgcmVsZXZhbnQgZGF0YXNldHMgZm9yIGJvdGggb3VyIHJlY29yZHMgYW5kIGZvciBkb3duc3RyZWFtIGFwcGxpY2F0aW9ucywgc3VjaCBhcyBmdW5jdGlvbmFsIGVucmljaG1lbnRzLgoKRmlyc3QsIHdlJ2xsIHNldHVwIGEgbmV3IGRpcmVjdG9yeSBmb3Igb3VyIG91dHB1dCB0YWJsZXMuCmBgYHtyIE91dHB1dFRhYmxlRGlyfQpkaXIuY3JlYXRlKCJ0YWJsZXMiLCBzaG93V2FybmluZ3MgPSBGQUxTRSkKYGBgCgojIyBERSByZXN1bHRzIHRhYmxlCgpOZXh0IHdlJ2xsIHdyaXRlIG91dCBvdXIgREUgcmVzdWx0cyBmb3IgdGhlIEtEIGNvbXBhcmlzb24gdG8gZmlsZSwgc2luY2Ugd2UgYWRkZWQgYWRkaXRpb25hbCBpbmZvcm1hdGlvbiB0byB0aGF0IHRhYmxlLgpgYGB7ciBERVJlc3VsdHNPdXB1dCwgZXZhbCA9IEZBTFNFfQp3cml0ZS5jc3YocmVzX1dUX2Fubm8sCiAgICAgICAgICByb3cubmFtZXMgPSBGQUxTRSwKICAgICAgICAgIG5hID0gIi4iLAogICAgICAgICAgZmlsZT0idGFibGVzL0RFUmVzdWx0c19rby5jb250cm9sX3Zfd3QuY29udHJvbF9hbm5vdGF0ZWQuY3N2IikKYGBgCgpJZiB3ZSBnZW5lcmF0ZWQgYW5vdGhlciBjb21wYXJpc2lvbiwgd2UgY291bGQgcmVwZWF0IG91ciBhbm5vdGF0aW9ucyBvciB3cml0ZSB0aGUgREUgcmVzdWx0cyBkaXJlY3RseSB0byBmaWxlLgoKYGBge3IgREVSZXN1bHRzT3VwdXQyLCBldmFsID0gRkFMU0V9CndyaXRlLmNzdihyZXN1bHRzX3BsdXNfdnNfbWludXMsCiAgICAgICAgICByb3cubmFtZXMgPSBGQUxTRSwKICAgICAgICAgIG5hID0gIi4iLAogICAgICAgICAgZmlsZT0idGFibGVzL0RFUmVzdWx0c19rby5UeF92X3d0LlR4LmNzdiIpCmBgYAoKIyMgQ291bnQgdGFibGVzCgpUaGUgbW9zdCByZWxldmFudCBjb3VudCB0YWJsZXMgYXJlIHRoZSByYXcsIGZpbHRlcmVkIGNvdW50IHRhYmxlIHRoYXQgd2UgdXNlZCBhcyB0aGUgaW5wdXQgZm9yIG91ciBhbmFseXNpcyBhbmQgdGhlIHJsb2cgbm9ybWFsaXplZCBjb3VudCB0YWJsZSB0aGF0IHdlIHVzZWQgZm9yIG91ciBxdWFsaXR5IGNvbnRyb2wgdmlzdWFsaXphdGlvbnMuCgpUbyBvdXRwdXQgdGhlIHJhdyBjb3VudHMsIHdlIHdpbGwgbmVlZCB0byB1c2UgdGhlIGBjb3VudHNgIGZ1bmN0aW9uIHRvIGFjY2VzcyB0aGUgY291bnQgdGFibGUgZnJvbSB3aXRoaW4gaXRzIGxhcmdlciBgREVTZXFEYXRhU2V0YCBvYmplY3QuCgpgYGB7ciBPdXRwdXRDb3VudHNSYXcsIGV2YWwgPSBGQUxTRX0Kd3JpdGUuY3N2KGNvdW50cyhkZHMsIG5vcm1hbGl6ZWQgPSBGQUxTRSksIGZpbGU9InRhYmxlcy9ERVNlcTJfcmF3X2NvdW50cy5jc3YiKQpgYGAKClRoZW4gd2UnbGwgb3V0cHV0IHRoZSBybG9nIGNvdW50IHRhYmxlLCB1c2luZyB0aGUgYGFzc2F5YCBmdW5jdGlvbiB0byBhY2Nlc3MgdGhlIG5vcm1hbGl6ZWQgY291bnQgdGFibGUgZnJvbSB3aXRoaW4gaXRzIGxhcmdlciBgREVTZXFEYXRhU2V0YCBvYmplY3QuCgpgYGB7ciBPdXRwdXRDb3VudHNSbG9nLCBldmFsID0gRkFMU0V9CndyaXRlLmNzdihhc3NheShybGQpLCBmaWxlPSJ0YWJsZXMvREVTZXEyX3Jsb2dOb3JtYWxpemVkX2NvdW50cy5jc3YiKQpgYGAKCiMgU3VtbWFyeQoKSW4gdGhpcyBzZWN0aW9uLCB3ZToKCiogR2VuZXJhdGVkIGEgdm9sY2FubyBwbG90IGZvciBvdXIgZGlmZmVyZW50aWFsIGV4cHJlc3Npb24gcmVzdWx0cwoqIFN1bW1hcml6ZWQgb3VyIGRpZmZlcmVudGlhbCBleHByZXNzaW9uIHJlc3VsdHMKKiBEaXNjdXNzZWQgY2hvb3NpbmcgdGhyZXNob2xkcwoqIEFubm90YXRlZCBvdXIgdGFibGVzIG9mIHJlc3VsdHMgdG8gbWFwIGdlbmUgSURzIHRvIGdlbmUgc3ltYm9scwoqIFNhdmVkIG91ciByZXN1bHRzIHRvIGZpbGUKCgojIEtleSB0YWtlYXdheXMKCk92ZXJhbGwsIHdlJ3ZlIHJ1biB0aHJvdWdoIG1vc3Qgb2YgdGhlIGJ1aWxkaW5nIGJsb2NrcyBuZWVkZWQgdG8gcnVuIGEgZGlmZmVyZW50aWFsIGV4cHJlc3Npb24gYW5hbHlzaXMgYW5kIGhvcGVmdWxseSBidWlsdCB1cCBhIGJldHRlciB1bmRlcnN0YW5kaW5nIG9mIGhvdyBkaWZmZXJlbnRpYWwgZXhwcmVzc2lvbiBjb21wYXJpc29ucyB3b3JrLCBwYXJ0aWN1bGFybHkgaG93IGV4cGVyaW1lbnRhbCBkZXNpZ24gY2FuIGltcGFjdCBvdXIgcmVzdWx0cy4KCldoYXQgdG8gY29uc2lkZXIgbW92aW5nIGZvcndhcmQ6CgoqIEhvdyBjYW4gSSBjb250cm9sIGZvciB0ZWNobmljYWwgdmFyaWF0aW9uIGluIG15IGV4cGVyaW1lbnRhbCBkZXNpZ24/CiogSG93IG11Y2ggdmFyaWF0aW9uIGlzIGV4cGVjdGVkIHdpdGggYSB0cmVhdG1lbnQgZ3JvdXA/CiogV2hhdCBpcyBteSBSTkEgcXVhbGl0eSwgYW5kIGhvdyBjYW4gdGhhdCBiZSBvcHRpbWl6ZWQ/CiogQXJlIHRoZXJlIHF1YWxpdHkgY29uY2VybnMgZm9yIG15IHNlcXVlbmNpbmcgZGF0YT8KKiBXaGF0IGNvbXBhcmlzb25zIGFyZSByZWxldmFudCB0byBteSBiaW9sb2dpY2FsIHF1ZXN0aW9uPwoqIEFyZSB0aGVyZSBjb3ZhcmlhdGVzIHRoYXQgc2hvdWxkIGJlIGNvbnNpZGVyZWQ/CiogV2hhdCB3aWxsIGEgZGlmZmVyZW50aWFsIGV4cHJlc3Npb24gYW5hbHlzaXMgdGVsbCBtZT8KCgoqKkxldCdzIHBhdXNlIGhlcmUgZm9yIGdlbmVyYWwgcXVlc3Rpb25zKioKCi0tLQoKIyBXaGF0IGNhbiB3ZSBkbyB3aXRoIG91ciBERSByZXN1bHRzPwoKTm93IHRoYXQgd2UgaGF2ZSBvdXIgREUgcmVzdWx0cywgaGF2ZSB3ZSBhZGRyZXNzIHRoZSBiaW9sb2dpY2FsIHF1ZXN0aW9uIHJlbGV2YW50IHRvIHRoZSBhdXRob3JzIG9mIHRoZSBbb3JpZ2luYWwgcGFwZXJdKGh0dHA6Ly93d3cubmNiaS5ubG0ubmloLmdvdi9wdWJtZWQvMjU0NjQ4NDkpPyBPbiB0aGUgb25lIGhhbmQsIHllcyAtIHdlIG5vdyBoYXZlIHR3byB0YWJsZXMgb2YgZ2VuZXMgdGhhdCBhcmUgaW1wYWN0ZWQgYnkgY2hhbmdlIGluIE1vdjEwIGV4cHJlc3Npb24uIEJ1dCB3aXRoIHR3byBsaXN0cyBvZiBnZW5lcyBhbG9uZSwgaXQgY2FuIGJlIGRpZmZpY3VsdCB0byBmaW5kIHBhdHRlcm5zIG9yIHVuZGVyc3RhbmQgYnJvYWRlciBiaW9sb2dpY2FsIGltcGFjdHMuCgpXaGF0IGlmIHdlIHdhbnRlZCB0byBmaW5kIG91dCB3aGF0IGdlbmVzIHdlcmUgc2lnbmlmYW50IGluICpib3RoKiBjb21wYXJpc29ucz8gVGhlIGBpbnRlcnNlY3RgIGZ1bmN0aW9uLCBzdWNoIGFzIGltcGxpbWVudGVkIGFzIFtwYXJ0IG9mIHRoZSBkcGx5ciBwYWNrYWdlXShodHRwczovL3d3dy5kYXRhc2NpZW5jZW1hZGVzaW1wbGUuY29tL2ludGVyc2VjdC1mdW5jdGlvbi1yLXVzaW5nLWRwbHlyLWludGVyc2VjdGlvbi1kYXRhLWZyYW1lcy8pIHdvdWxkIGJlIHVzZWZ1bCB0byBpZGVudGlmeSBzaGFyZWQgc2lnbmlmaWNhbnQgZ2VuZXMuIEEgW3Zlbm4gZGlhZ3JhbV0oaHR0cHM6Ly93d3cuci1ncmFwaC1nYWxsZXJ5LmNvbS8xNC12ZW5uLWRpYWdyYW1tLmh0bWwpIGNvdWxkIGJlIGEgd2F5IHRvIHZpc3VhbGl6ZSB0aGVzZSBvdmVybGFwcy4KCkEgd2F5IHRvIGRldGVybWluZSBwb3NzaWJsZSBbYnJvYWRlciBiaW9sb2dpY2FsIGludGVycHJldGF0aW9uc10oaHR0cHM6Ly93d3cuZWJpLmFjLnVrL3RyYWluaW5nLWJldGEvb25saW5lL2NvdXJzZXMvZnVuY3Rpb25hbC1nZW5vbWljcy1paS1jb21tb24tdGVjaG5vbG9naWVzLWFuZC1kYXRhLWFuYWx5c2lzLW1ldGhvZHMvYmlvbG9naWNhbC1pbnRlcnByZXRhdGlvbi1vZi1nZW5lLWV4cHJlc3Npb24tZGF0YS0yLykgZnJvbSB0aGUgb2JzZXJ2ZWQgREUgcmVzdWx0cywgaXMgZnVuY3Rpb25hbCBlbnJpY2htZW50cy4gVGhlcmUgYXJlIG1hbnkgb3B0aW9ucywgc3VjaCBhcyBzb21lIGluY2x1ZGVkIGluIHRoaXMgW2Rpc2N1c3Npb24gdGhyZWFkXShodHRwczovL3d3dy5yZXNlYXJjaGdhdGUubmV0L3Bvc3QvSG93X2Nhbl9JX2FuYWx5emVfYV9zZXRfb2ZfREVHc19kaWZmZXJlbnRpYWxseV9leHByZXNzZWRfZ2VuZXNfdG9fb2J0YWluX2luZm9ybWF0aW9uX2Zyb21fdGhlbSkuIE90aGVyIGNvbW1vbiBmdW5jdGlvbmFsIGVucmljaG1lbnRzIGFwcHJvYWNoZXMgYXJlIGdlbmUgc2V0IGVucmljaG1lbnQgYW5hbHlzaXMsIGFrYSBbR1NFQV0oaHR0cDovL3NvZnR3YXJlLmJyb2FkaW5zdGl0dXRlLm9yZy9nc2VhL2luZGV4LmpzcCksIERhdGFiYXNlIGZvciBBbm5vdGF0aW9uLCBWaXN1YWxpemF0aW9uIGFuZCBJbnRlZ3JhdGVkIERpc2NvdmVyeSwgYWthIFtEQVZJRF0oaHR0cHM6Ly9kYXZpZC5uY2lmY3JmLmdvdi8pLCBbSW5nZW5pdHldKGh0dHBzOi8vZGlnaXRhbGluc2lnaHRzLnFpYWdlbi5jb20vKSwgYW5kIFtpUGF0aHdheSBHdWlkZV0KClRoZSBVbml2ZXJzaXR5IG9mIE1pY2hpZ2FuIGhhcyBsaWNlbnNlIGFuZCBzdXBwb3J0IGZvciBhZGRpdGlvbmFsIHRvb2xzLCBzdWNoIGFzIEN5dG9zY2FwZSwgc28gd2UgcmVjb21tZW5kIHJlYWNoaW5nIG91dCB0byBzdGFmZiB3aXRoIFtUYXVibWFuIExpYnJhcnldKGh0dHBzOi8vd3d3LmxpYi51bWljaC5lZHUvbG9jYXRpb25zLWFuZC1ob3Vycy90YXVibWFuLWhlYWx0aC1zY2llbmNlcy1saWJyYXJ5L3Jlc2VhcmNoLWFuZC1jbGluaWNhbC1zdXBwb3J0KSB0byBsZWFybiBtb3JlIGFib3V0IHJlc291cmNlcyB0aGF0IG1pZ2h0IGJlIGFwcGxpY2F0aW9uIHRveW91ciByZXNlYXJjaC4KCi0tLQoKIyBTb3VyY2VzCgoqIEhCQyBER0UgdHJhaW5pbmcgbW9kdWxlLCBwYXJ0IDE6IGh0dHBzOi8vaGJjdHJhaW5pbmcuZ2l0aHViLmlvL0RHRV93b3Jrc2hvcC9sZXNzb25zLzA0X0RHRV9ERVNlcTJfYW5hbHlzaXMuaHRtbAoqIEhCQyBER0UgdHJhaW5pbmcgbW9kdWxlLCBwYXJ0IDI6IGh0dHBzOi8vaGJjdHJhaW5pbmcuZ2l0aHViLmlvL0RHRV93b3Jrc2hvcC9sZXNzb25zLzA1X0RHRV9ERVNlcTJfYW5hbHlzaXMyLmh0bWwKKiBERVNlcTIgdmlnbmV0dGU6IGh0dHA6Ly9iaW9jb25kdWN0b3Iub3JnL3BhY2thZ2VzL2RldmVsL2Jpb2MvdmlnbmV0dGVzL0RFU2VxMi9pbnN0L2RvYy9ERVNlcTIuaHRtbCNkaWZmZXJlbnRpYWwtZXhwcmVzc2lvbi1hbmFseXNpcwoqIEJpb2NvbmR1Y3RvciBHZW5vbWljIEFubm90YXRpb24gcmVzb3VyY2VzOiBodHRwOi8vYmlvY29uZHVjdG9yLm9yZy9wYWNrYWdlcy9kZXZlbC93b3JrZmxvd3MvdmlnbmV0dGVzL2Fubm90YXRpb24vaW5zdC9kb2MvQW5ub3RhdGlvbl9SZXNvdXJjZXMuaHRtbAoqIEJpb01hcnQgdmlnbmV0dGU6IGh0dHBzOi8vYmlvY29uZHVjdG9yLm9yZy9wYWNrYWdlcy9yZWxlYXNlL2Jpb2MvdmlnbmV0dGVzL2Jpb21hUnQvaW5zdC9kb2MvYWNjZXNzaW5nX2Vuc2VtYmwuaHRtbAoKIyBBZGRpdGlvbmFsIFJlc291cmNlcwoqIE1JREFTIFJlcHJvZHVjaWJsaXR5IEh1YjogaHR0cHM6Ly9taWRhcy51bWljaC5lZHUvcmVwcm9kdWNpYmlsaXR5LW92ZXJ2aWV3LwoqIEFSQyByZXNvdXJjZXM6IGh0dHBzOi8vYXJjLXRzLnVtaWNoLmVkdS8KKiBHZW5lIFNldCBFbnJpY2htZW50IFJlc291cmNlcyBmcm9tIEJpb2NvbmR1Y3RvcjogaHR0cHM6Ly9iaW9pbmZvcm1hdGljcy1jb3JlLXNoYXJlZC10cmFpbmluZy5naXRodWIuaW8vY3J1ay1zdW1tZXItc2Nob29sLTIwMTgvUk5BU2VxMjAxOC9odG1sLzA2X0dlbmVfc2V0X3Rlc3RpbmcubmIuaHRtbAoqIFVzaW5nIEhUU2VxIGRhdGEgd2l0aCBERVNlcTI6IGh0dHBzOi8vYW5ndXMucmVhZHRoZWRvY3MuaW8vZW4vMjAxOS9kaWZmLWV4LWFuZC12aXouaHRtbAoqIERldGFpbGVkIFJOQS1zZXEgYW5hbHlzaXMgcGFwZXI6IGh0dHBzOi8vd3d3Lm5jYmkubmxtLm5paC5nb3YvcG1jL2FydGljbGVzL1BNQzYwOTYzNDYvCiogT3ZlcnZpZXcgb2YgUk5BLXNlcSBhbmFseXNpcyBjb25zaWRlcmF0aW9uczogaHR0cHM6Ly9hY2FkZW1pYy1vdXAtY29tLnByb3h5LmxpYi51bWljaC5lZHUvYmZnL2FydGljbGUvMTQvMi8xMzAvMjU3MzcwCiogQWx0ZXJuYXRpdmUgb3ZlcnZpZXcgb2YgREVTZXEyLCBpbmNsdWRpbmcgdmlzdWFsaXphdGlvbnMgYW5kIGZ1bmN0aW9uYWwgZW5yaWNobWVudHM6IGh0dHA6Ly9kcHV0aGllci5naXRodWIuaW8vamdiNzFlLXBvbHl0ZWNoLWJpb2luZm8tYXBwL3ByYWN0aWNhbC9ybmEtc2VxX1Ivcm5hc2VxX2RpZmZfU25mMi5odG1sCgotLS0KCmBgYHtyIFdyaXRlT3V0LlJEYXRhLCBldmFsPVRSVUUsIGVjaG89RkFMU0UsIG1lc3NhZ2U9RkFMU0UsIHdhcm5pbmc9RkFMU0V9CiNIaWRkZW4gY29kZSBibG9jayB0byB3cml0ZSBvdXQgZGF0YSBmb3Iga25pdHRpbmcKc2F2ZS5pbWFnZShmaWxlID0gInJkYXRhL1J1bm5pbmdEYXRhX0Z1bGwuUkRhdGEiKQpgYGAKCiMgU2Vzc2lvbiBJbmZvCmBgYHtyIFNlc3Npb25JbmZvfQpzZXNzaW9uSW5mbygpCmBgYAoKLS0tCgpUaGVzZSBtYXRlcmlhbHMgaGF2ZSBiZWVuIGFkYXB0ZWQgYW5kIGV4dGVuZGVkIGZyb20gbWF0ZXJpYWxzIGxpc3RlZCBhYm92ZS4gVGhlc2UgYXJlIG9wZW4gYWNjZXNzIG1hdGVyaWFscyBkaXN0cmlidXRlZCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIFtDcmVhdGl2ZSBDb21tb25zIEF0dHJpYnV0aW9uIGxpY2Vuc2UgKENDIEJZIDQuMCldKGh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LzQuMC8pLCB3aGljaCBwZXJtaXRzIHVucmVzdHJpY3RlZCB1c2UsIGRpc3RyaWJ1dGlvbiwgYW5kIHJlcHJvZHVjdGlvbiBpbiBhbnkgbWVkaXVtLCBwcm92aWRlZCB0aGUgb3JpZ2luYWwgYXV0aG9yIGFuZCBzb3VyY2UgYXJlIGNyZWRpdGVkLgo=</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("Module11_DEVisualizations.Rmd");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
